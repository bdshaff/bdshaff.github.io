<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> Binary Image Classification with Keras in R - Ben&#39;s Data Science </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="Description for the page" />
    <meta property="og:site_name" content="Ben&#39;s Data Science" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/" />
    <meta property="og:title" content="Binary Image Classification with Keras in R" />
    <meta property="og:image" content="https://bdshaff.github.io/images/image.png" />
    <meta property="og:description" content="Description for the page" />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:title" content="Binary Image Classification with Keras in R" />
    <meta name="twitter:description" content="Description for the page" />
    <meta name="twitter:image" content="https://bdshaff.github.io/images/image.png" />

    <link rel="canonical" href="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous" />

    <link rel="stylesheet" href="https://bdshaff.github.io/css/custom.css" />

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github-gist.min.css" integrity="sha512-od7JLoOTxM8w/HSKGzP9Kexc20K9p/M2zxSWsd7H1e4Ctf+8SQFtCWEZnW5u6ul5ehSECa5QmOk9ju2nQMmlVA==" crossorigin="anonymous" />
    

    

    <link rel="shortcut icon"
        href="https://bdshaff.github.io/images/favicon.png">

    
    <link href="https://bdshaff.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Ben&#39;s Data Science" />
    
</head>

<body>
    
<div class="mt-xl header">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-auto">
                <a href="https://bdshaff.github.io/">
                    <h1 class="name">Ben&#39;s Data Science</h1>
                </a>
            </div>
        </div>

        <div class="row justify-content-center">
            <ul class="nav nav-primary">
                
                <li class="nav-item">
                    <a class="nav-link" href="https://bdshaff.github.io/">
                        
                        Home
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://bdshaff.github.io/about/">
                        
                        About
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://github.com/bdshaff">
                        
                        GitHub
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://medium.com/@bdshaff">
                        
                        Medium
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://www.linkedin.com/in/bendenisshaffer/">
                        
                        LinkedIn
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

<div class="content">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-sm-12 col-lg-8">
                <h1 class="mx-0 mx-md-4 blog-post-title">Binary Image Classification with Keras in R</h1>

                <div class="mb-md-4 meta">
                    
                    
                    <span class="author" title="Package Build">
                        Package Build
                    </span>
                    
                    

                    <span class="date middot" title='Mon May 31 2021 00:00:00 UTC'>
                        2021-05-31
                    </span>

                    <span class="reading-time middot">
                        21 min read
                    </span>

                    <div class="d-none d-md-inline tags">
                        <ul class="list-unstyled d-inline">
                            
                            <li class="d-inline middot">
                                <a href="https://bdshaff.github.io/tags/keras">Keras</a>
                            </li>
                            
                            <li class="d-inline middot">
                                <a href="https://bdshaff.github.io/tags/tensorflow">Tensorflow</a>
                            </li>
                            
                        </ul>
                    </div>
                </div>

                <div class="markdown blog-post-content">
                    
    
<script src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/header-attrs/header-attrs.js"></script>
<script src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/htmlwidgets/htmlwidgets.js"></script>
<script src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/plotly-binding/plotly.js"></script>
<script src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/typedarray/typedarray.min.js"></script>
<script src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/jquery/jquery.min.js"></script>
<link href="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/crosstalk/js/crosstalk.min.js"></script>
<link href="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/plotly-main/plotly-latest.min.js"></script>


<div id="binary-image-classification-with-keras-in-r-apple-m1-chip" class="section level1">
<h1>Binary Image Classification with Keras in R (Apple M1 Chip)</h1>
<p>This my first real exploration of the Keras and the use of CNNs for image classification. The exercise is done on hardware with an Apple M1 Chip and using R interface to Keras. This means that the versions of R, Python, TensorFlow and Keras are all versions that run natively on the M1 Chip. If you prefer to use R and use an M1 mac then here are a few useful links:</p>
<ul>
<li><p><a href="https://cran.r-project.org/bin/macosx/">R 4.1.0-arm64.pkg is the official release of R that runs natively on Apple silicon arm64.</a></p></li>
<li><p><a href="https://dailies.rstudio.com/rstudio/oss/mac/">Rstudio Daily Builds will work with this version of R</a>.</p></li>
<li><p><a href="https://github.com/conda-forge/miniforge#miniforge3">Miniforge3 for arm64 Python</a>.</p></li>
<li><p><a href="https://github.com/apple/tensorflow_macos">Version of TF that will run on M1</a>.</p></li>
<li><p><a href="https://medium.com/codex/installing-tensorflow-on-m1-macs-958767a7a4b3">A blog with instruction to setup TF and Python for M1 Chip</a>.</p></li>
</ul>
<p>To then make this available in R just need to use <code>reticulate::use_condaenv</code> and point to the environment where the Python and TF were setup.</p>
<pre class="r"><code>library(tensorflow)
library(keras)
library(purrr)
library(imager)
library(stringr)

reticulate::use_condaenv(&quot;~/miniforge3/envs/python38/&quot;)</code></pre>
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<p>For this exercise I am using a data-set from Kaggle which was used for the <a href="https://www.kaggle.com/puneet6060/intel-image-classification">Intel Image Classification competition.</a> The original task is a multiclass classification with building, street, forest, glacier, mountain, sea as labels. For my purposes I simplified the task to a binary classification and used gray-scale images even though colored images are available.</p>
<p>Here is the structure of the data in this project. building, Street are grouped to make a first class, and forest, glacier, mountain, sea are grouped to make the second class.</p>
<pre class="r"><code>fs::dir_tree(paste0(path, &quot;/data&quot;), recurse = 2, regexp = &quot;train|test&quot;)</code></pre>
<pre><code>## ~/Documents/Ben&#39;s Data Science/Intel Image Classifiction/data
## ├── test
## │   ├── city
## │   │   ├── buildings
## │   │   └── street
## │   └── nature
## │       ├── forest
## │       ├── glacier
## │       ├── mountain
## │       └── sea
## └── train
##     ├── city
##     │   ├── buildings
##     │   └── street
##     └── nature
##         ├── forest
##         ├── glacier
##         ├── mountain
##         └── sea</code></pre>
<div id="loading-image-data-in-r" class="section level2">
<h2>Loading Image Data in R</h2>
<p>There are a couple of ways to read in the images into R. One way is to use <code>imager::load.image</code> function. The advantage is that we get an object of class <code>cimg</code> which is easy to manipulate, plot, and cast to an array. For ML and for building models in Keras using <code>keras::image_load()</code> and <code>keras::image_to_array()</code> is more convenient because we can specify if we want to grayscale images and the target size. Images all need to be of the same dimension. We expect 150x150 images in this data, but some images are in fact of a different size and would need to be further processed or excluded. <code>keras::image_load()</code> very conveniently helps us take care of this issue.</p>
<pre class="r"><code>train_image_files = list.files(paste0(path,&quot;/data/train&quot;), 
                               recursive = TRUE, 
                               full.names = TRUE)

train_labels = map_chr(train_image_files, ~ifelse(
  str_detect(.x,&quot;city&quot;), &quot;city/building&quot;,&quot;nature&quot;))

y_train = to_categorical(as.numeric(as.factor(train_labels)), num_classes = 3)[,2:3]

test_image_files = list.files(paste0(path,&quot;/data/test&quot;), 
                              recursive = TRUE, 
                              full.names = TRUE)
test_labels = map_chr(test_image_files, ~ifelse(
  str_detect(.x,&quot;city&quot;), &quot;city/building&quot;,&quot;nature&quot;))

y_test = to_categorical(as.numeric(as.factor(test_labels)), num_classes = 3)[,2:3]</code></pre>
<pre class="r"><code>train_data = map(train_image_files, 
                ~image_load(.x, target_size = c(150,150), grayscale = TRUE) %&gt;% 
                  image_to_array() %&gt;% 
                  divide_by(255)
                )

test_data = map(test_image_files, 
                ~image_load(.x, target_size = c(150,150), grayscale = TRUE) %&gt;% 
                  image_to_array() %&gt;% 
                  divide_by(255)
                )</code></pre>
<p>When the data is loaded using <code>purrr::map</code> we get back a list of images. This is very convenient for certain use cases but for Keras we need to use <code>arrays</code> which are higher dimensional matrices. Thankfully it is not very difficult to restructure the data into one big array and give it the right dimensions using base R functions <code>array</code> <code>unlist</code> and <code>aperm</code>.</p>
<pre class="r"><code>X_test = 
  array(unlist(test_data), 
        dim = c(150, 150, 1, length(test_data))) %&gt;% 
  aperm(c(4,1,2,3))

X_train = 
  array(unlist(train_data), 
        dim = c(150, 150, 1, length(train_data))) %&gt;% 
  aperm(c(4,1,2,3))</code></pre>
</div>
<div id="sample-images" class="section level2">
<h2>Sample Images</h2>
<p>To visualize a sample image from either the test of train sets it is easy to simply slice the resultant array of data and cast back to <code>cimg</code>.</p>
<pre class="r"><code>par(mfrow = c(1,2), mar = c(1,1,1,1))
as.cimg(X_test[2000, , , ])  %&gt;% 
  imrotate(90) %&gt;% 
  plot(axes = FALSE, main = test_labels[2000])

as.cimg(X_train[1, , , ]) %&gt;% 
  imrotate(90) %&gt;% 
  plot(axes = FALSE, main = train_labels[1])</code></pre>
<p><img src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/figure-html/viz-img-example-1.png" width="672" /></p>
</div>
</div>
<div id="convolutional-neural-network" class="section level1">
<h1>Convolutional Neural Network</h1>
<div id="define-model" class="section level2">
<h2>Define Model</h2>
<p>Images are represented as 2D or 3D (if colored) array which can be reshaped to 1D vectors. We can train a model using this 1D vector representation but even intuitively this feel like we are giving up important information. Convolutional Neural Networks, or networks with convolutional layers are particularly useful when it comes to images because they allow us to retain and learn the importance of spacial relations within the samples. When we create a conv layer with 120 filters we create a layer with 120 nodes each of which takes as an input a kernel size section of an image and will serve as an input for the subsequent layers.</p>
<pre class="r"><code>model = keras_model_sequential()
model %&gt;% 
  layer_conv_2d(120, kernel_size = 3, strides = 2, activation = &quot;relu&quot;, 
                input_shape = c(150, 150, 1)) %&gt;%
  layer_max_pooling_2d(2) %&gt;%
  layer_conv_2d(60, kernel_size = 3, strides = 2, activation = &quot;relu&quot;) %&gt;%
  layer_conv_2d(60, kernel_size = 3, strides = 2, activation = &quot;relu&quot;) %&gt;%
  layer_max_pooling_2d(2) %&gt;%
  layer_conv_2d(40, kernel_size = 3, strides = 2, activation = &quot;relu&quot;) %&gt;%
  layer_flatten() %&gt;%
  #a dense layer with wo nodes and sigmoid binary activation to produce probabilities
  layer_dense(2, activation = &quot;sigmoid&quot;)</code></pre>
<pre class="r"><code>summary(model)</code></pre>
<pre><code>## Model: &quot;sequential&quot;
## ________________________________________________________________________________
## Layer (type)                        Output Shape                    Param #     
## ================================================================================
## conv2d_3 (Conv2D)                   (None, 74, 74, 120)             1200        
## ________________________________________________________________________________
## max_pooling2d_1 (MaxPooling2D)      (None, 37, 37, 120)             0           
## ________________________________________________________________________________
## conv2d_2 (Conv2D)                   (None, 18, 18, 60)              64860       
## ________________________________________________________________________________
## conv2d_1 (Conv2D)                   (None, 8, 8, 60)                32460       
## ________________________________________________________________________________
## max_pooling2d (MaxPooling2D)        (None, 4, 4, 60)                0           
## ________________________________________________________________________________
## conv2d (Conv2D)                     (None, 1, 1, 40)                21640       
## ________________________________________________________________________________
## flatten (Flatten)                   (None, 40)                      0           
## ________________________________________________________________________________
## dense (Dense)                       (None, 2)                       82          
## ================================================================================
## Total params: 120,242
## Trainable params: 120,242
## Non-trainable params: 0
## ________________________________________________________________________________</code></pre>
</div>
<div id="compile-and-fit" class="section level2">
<h2>Compile and Fit</h2>
<p>Defining the Loss function and the optimization procedure are likewise very simple to do thanks to Keras.</p>
<pre class="r"><code>model %&gt;% 
  compile(
    loss = &quot;binary_crossentropy&quot;,
    optimizer = &quot;adam&quot;,
    metrics = &quot;accuracy&quot;
  )</code></pre>
<p>Here we are using the test data for validation during the learning process.</p>
<pre class="r"><code>history =
  model %&gt;%
  fit(
    x = X_train, y = y_train,
    validation_data = list(X_test, y_test),
    epochs = 10,
    batch_size = 10
  )</code></pre>
</div>
<div id="training-history" class="section level2">
<h2>Training History</h2>
<p>From the training history we can see that the model reaches a relatively good level of accuracy and perhaps begins to over-fit somewhat by the 6th epoch. From the plot we see that the model reaches a ~94% prediction accuracy on the test set of images and a slightly higher ~95% prediction accuracy on the train set.</p>
<pre class="r"><code>plotly::ggplotly(
  plot(history)
)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10],"y":[0.449863463640213,0.299880266189575,0.244718998670578,0.200180634856224,0.17804254591465,0.160206913948059,0.138695672154427,0.125394269824028,0.114590384066105,0.0992107093334198],"text":["data: 1<br />data: training<br />epoch:  1<br />value: 0.44986346","data: 1<br />data: training<br />epoch:  2<br />value: 0.29988027","data: 1<br />data: training<br />epoch:  3<br />value: 0.24471900","data: 1<br />data: training<br />epoch:  4<br />value: 0.20018063","data: 1<br />data: training<br />epoch:  5<br />value: 0.17804255","data: 1<br />data: training<br />epoch:  6<br />value: 0.16020691","data: 1<br />data: training<br />epoch:  7<br />value: 0.13869567","data: 1<br />data: training<br />epoch:  8<br />value: 0.12539427","data: 1<br />data: training<br />epoch:  9<br />value: 0.11459038","data: 1<br />data: training<br />epoch: 10<br />value: 0.09921071"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"(training,1)","legendgroup":"(training,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10],"y":[0.789511203765869,0.879079401493073,0.9036625623703,0.92546671628952,0.933019816875458,0.940644145011902,0.949479818344116,0.954610228538513,0.959954380989075,0.96451473236084],"text":["data: 1<br />data: training<br />epoch:  1<br />value: 0.78951120","data: 1<br />data: training<br />epoch:  2<br />value: 0.87907940","data: 1<br />data: training<br />epoch:  3<br />value: 0.90366256","data: 1<br />data: training<br />epoch:  4<br />value: 0.92546672","data: 1<br />data: training<br />epoch:  5<br />value: 0.93301982","data: 1<br />data: training<br />epoch:  6<br />value: 0.94064415","data: 1<br />data: training<br />epoch:  7<br />value: 0.94947982","data: 1<br />data: training<br />epoch:  8<br />value: 0.95461023","data: 1<br />data: training<br />epoch:  9<br />value: 0.95995438","data: 1<br />data: training<br />epoch: 10<br />value: 0.96451473"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"(training,2)","legendgroup":"(training,2)","showlegend":true,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10],"y":[0.329428791999817,0.254868298768997,0.225823879241943,0.18313767015934,0.307141959667206,0.248651340603828,0.212574854493141,0.183659240603447,0.169193625450134,0.198422461748123],"text":["data: 1<br />data: validation<br />epoch:  1<br />value: 0.32942879","data: 1<br />data: validation<br />epoch:  2<br />value: 0.25486830","data: 1<br />data: validation<br />epoch:  3<br />value: 0.22582388","data: 1<br />data: validation<br />epoch:  4<br />value: 0.18313767","data: 1<br />data: validation<br />epoch:  5<br />value: 0.30714196","data: 1<br />data: validation<br />epoch:  6<br />value: 0.24865134","data: 1<br />data: validation<br />epoch:  7<br />value: 0.21257485","data: 1<br />data: validation<br />epoch:  8<br />value: 0.18365924","data: 1<br />data: validation<br />epoch:  9<br />value: 0.16919363","data: 1<br />data: validation<br />epoch: 10<br />value: 0.19842246"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"(validation,1)","legendgroup":"(validation,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10],"y":[0.860666692256927,0.898000001907349,0.913333356380463,0.933000028133392,0.873000025749207,0.908333361148834,0.924333333969116,0.933333337306976,0.93966668844223,0.932666659355164],"text":["data: 1<br />data: validation<br />epoch:  1<br />value: 0.86066669","data: 1<br />data: validation<br />epoch:  2<br />value: 0.89800000","data: 1<br />data: validation<br />epoch:  3<br />value: 0.91333336","data: 1<br />data: validation<br />epoch:  4<br />value: 0.93300003","data: 1<br />data: validation<br />epoch:  5<br />value: 0.87300003","data: 1<br />data: validation<br />epoch:  6<br />value: 0.90833336","data: 1<br />data: validation<br />epoch:  7<br />value: 0.92433333","data: 1<br />data: validation<br />epoch:  8<br />value: 0.93333334","data: 1<br />data: validation<br />epoch:  9<br />value: 0.93966669","data: 1<br />data: validation<br />epoch: 10<br />value: 0.93266666"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"(validation,2)","legendgroup":"(validation,2)","showlegend":true,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,1.11392405063291,1.22784810126582,1.34177215189873,1.45569620253165,1.56962025316456,1.68354430379747,1.79746835443038,1.91139240506329,2.0253164556962,2.13924050632911,2.25316455696203,2.36708860759494,2.48101265822785,2.59493670886076,2.70886075949367,2.82278481012658,2.93670886075949,3.0506329113924,3.16455696202532,3.27848101265823,3.39240506329114,3.50632911392405,3.62025316455696,3.73417721518987,3.84810126582278,3.9620253164557,4.07594936708861,4.18987341772152,4.30379746835443,4.41772151898734,4.53164556962025,4.64556962025316,4.75949367088608,4.87341772151899,4.9873417721519,5.10126582278481,5.21518987341772,5.32911392405063,5.44303797468354,5.55696202531646,5.67088607594937,5.78481012658228,5.89873417721519,6.0126582278481,6.12658227848101,6.24050632911392,6.35443037974684,6.46835443037975,6.58227848101266,6.69620253164557,6.81012658227848,6.92405063291139,7.0379746835443,7.15189873417722,7.26582278481013,7.37974683544304,7.49367088607595,7.60759493670886,7.72151898734177,7.83544303797468,7.94936708860759,8.0632911392405,8.17721518987342,8.29113924050633,8.40506329113924,8.51898734177215,8.63291139240506,8.74683544303797,8.86075949367089,8.9746835443038,9.08860759493671,9.20253164556962,9.31645569620253,9.43037974683544,9.54430379746835,9.65822784810127,9.77215189873418,9.88607594936709,10],"y":[0.4400461019161,0.424706124075745,0.40986459300572,0.395516106665005,0.381655263012577,0.368276660007414,0.355374895608495,0.342944567774799,0.330980274465303,0.319479760865458,0.308517008422361,0.298102132459535,0.288204111774326,0.278791925164082,0.269834551426149,0.261300969357874,0.253160157756604,0.245381095419685,0.238023961996025,0.231690081694148,0.226334464616784,0.221761134176816,0.217774113787127,0.214177426860599,0.210775096810115,0.207371147048557,0.203769600988809,0.199980024282416,0.19653315155617,0.193408833531726,0.190537883328603,0.187851114066321,0.185279338864398,0.182753370842355,0.180204023119711,0.177562108815985,0.17494256492944,0.172565495955567,0.170381757630431,0.168339364147647,0.166386329700831,0.164470668483599,0.162540394689567,0.160543522512351,0.158428903241876,0.156239520065952,0.154035073493867,0.151830503088385,0.149640748412269,0.147480749028282,0.145365444499187,0.143309774387747,0.141328678256725,0.13943676316433,0.13763548403389,0.135909818909202,0.134243785332219,0.132621400844891,0.131026682989172,0.129443649307014,0.127856317340368,0.126248704631186,0.12461697945302,0.123009516739087,0.121431414018209,0.119880445236724,0.118354384340969,0.116851005277284,0.115368081992007,0.113903388431475,0.112454698542027,0.11102269281976,0.109612513784627,0.108223872800652,0.106856258071604,0.105509157801251,0.104182060193365,0.102874453451714,0.101585825780068,0.100315665382196],"text":["data: training<br />data: training<br />epoch:  1.000000<br />value: 0.4400461","data: training<br />data: training<br />epoch:  1.113924<br />value: 0.4247061","data: training<br />data: training<br />epoch:  1.227848<br />value: 0.4098646","data: training<br />data: training<br />epoch:  1.341772<br />value: 0.3955161","data: training<br />data: training<br />epoch:  1.455696<br />value: 0.3816553","data: training<br />data: training<br />epoch:  1.569620<br />value: 0.3682767","data: training<br />data: training<br />epoch:  1.683544<br />value: 0.3553749","data: training<br />data: training<br />epoch:  1.797468<br />value: 0.3429446","data: training<br />data: training<br />epoch:  1.911392<br />value: 0.3309803","data: training<br />data: training<br />epoch:  2.025316<br />value: 0.3194798","data: training<br />data: training<br />epoch:  2.139241<br />value: 0.3085170","data: training<br />data: training<br />epoch:  2.253165<br />value: 0.2981021","data: training<br />data: training<br />epoch:  2.367089<br />value: 0.2882041","data: training<br />data: training<br />epoch:  2.481013<br />value: 0.2787919","data: training<br />data: training<br />epoch:  2.594937<br />value: 0.2698346","data: training<br />data: training<br />epoch:  2.708861<br />value: 0.2613010","data: training<br />data: training<br />epoch:  2.822785<br />value: 0.2531602","data: training<br />data: training<br />epoch:  2.936709<br />value: 0.2453811","data: training<br />data: training<br />epoch:  3.050633<br />value: 0.2380240","data: training<br />data: training<br />epoch:  3.164557<br />value: 0.2316901","data: training<br />data: training<br />epoch:  3.278481<br />value: 0.2263345","data: training<br />data: training<br />epoch:  3.392405<br />value: 0.2217611","data: training<br />data: training<br />epoch:  3.506329<br />value: 0.2177741","data: training<br />data: training<br />epoch:  3.620253<br />value: 0.2141774","data: training<br />data: training<br />epoch:  3.734177<br />value: 0.2107751","data: training<br />data: training<br />epoch:  3.848101<br />value: 0.2073711","data: training<br />data: training<br />epoch:  3.962025<br />value: 0.2037696","data: training<br />data: training<br />epoch:  4.075949<br />value: 0.1999800","data: training<br />data: training<br />epoch:  4.189873<br />value: 0.1965332","data: training<br />data: training<br />epoch:  4.303797<br />value: 0.1934088","data: training<br />data: training<br />epoch:  4.417722<br />value: 0.1905379","data: training<br />data: training<br />epoch:  4.531646<br />value: 0.1878511","data: training<br />data: training<br />epoch:  4.645570<br />value: 0.1852793","data: training<br />data: training<br />epoch:  4.759494<br />value: 0.1827534","data: training<br />data: training<br />epoch:  4.873418<br />value: 0.1802040","data: training<br />data: training<br />epoch:  4.987342<br />value: 0.1775621","data: training<br />data: training<br />epoch:  5.101266<br />value: 0.1749426","data: training<br />data: training<br />epoch:  5.215190<br />value: 0.1725655","data: training<br />data: training<br />epoch:  5.329114<br />value: 0.1703818","data: training<br />data: training<br />epoch:  5.443038<br />value: 0.1683394","data: training<br />data: training<br />epoch:  5.556962<br />value: 0.1663863","data: training<br />data: training<br />epoch:  5.670886<br />value: 0.1644707","data: training<br />data: training<br />epoch:  5.784810<br />value: 0.1625404","data: training<br />data: training<br />epoch:  5.898734<br />value: 0.1605435","data: training<br />data: training<br />epoch:  6.012658<br />value: 0.1584289","data: training<br />data: training<br />epoch:  6.126582<br />value: 0.1562395","data: training<br />data: training<br />epoch:  6.240506<br />value: 0.1540351","data: training<br />data: training<br />epoch:  6.354430<br />value: 0.1518305","data: training<br />data: training<br />epoch:  6.468354<br />value: 0.1496407","data: training<br />data: training<br />epoch:  6.582278<br />value: 0.1474807","data: training<br />data: training<br />epoch:  6.696203<br />value: 0.1453654","data: training<br />data: training<br />epoch:  6.810127<br />value: 0.1433098","data: training<br />data: training<br />epoch:  6.924051<br />value: 0.1413287","data: training<br />data: training<br />epoch:  7.037975<br />value: 0.1394368","data: training<br />data: training<br />epoch:  7.151899<br />value: 0.1376355","data: training<br />data: training<br />epoch:  7.265823<br />value: 0.1359098","data: training<br />data: training<br />epoch:  7.379747<br />value: 0.1342438","data: training<br />data: training<br />epoch:  7.493671<br />value: 0.1326214","data: training<br />data: training<br />epoch:  7.607595<br />value: 0.1310267","data: training<br />data: training<br />epoch:  7.721519<br />value: 0.1294436","data: training<br />data: training<br />epoch:  7.835443<br />value: 0.1278563","data: training<br />data: training<br />epoch:  7.949367<br />value: 0.1262487","data: training<br />data: training<br />epoch:  8.063291<br />value: 0.1246170","data: training<br />data: training<br />epoch:  8.177215<br />value: 0.1230095","data: training<br />data: training<br />epoch:  8.291139<br />value: 0.1214314","data: training<br />data: training<br />epoch:  8.405063<br />value: 0.1198804","data: training<br />data: training<br />epoch:  8.518987<br />value: 0.1183544","data: training<br />data: training<br />epoch:  8.632911<br />value: 0.1168510","data: training<br />data: training<br />epoch:  8.746835<br />value: 0.1153681","data: training<br />data: training<br />epoch:  8.860759<br />value: 0.1139034","data: training<br />data: training<br />epoch:  8.974684<br />value: 0.1124547","data: training<br />data: training<br />epoch:  9.088608<br />value: 0.1110227","data: training<br />data: training<br />epoch:  9.202532<br />value: 0.1096125","data: training<br />data: training<br />epoch:  9.316456<br />value: 0.1082239","data: training<br />data: training<br />epoch:  9.430380<br />value: 0.1068563","data: training<br />data: training<br />epoch:  9.544304<br />value: 0.1055092","data: training<br />data: training<br />epoch:  9.658228<br />value: 0.1041821","data: training<br />data: training<br />epoch:  9.772152<br />value: 0.1028745","data: training<br />data: training<br />epoch:  9.886076<br />value: 0.1015858","data: training<br />data: training<br />epoch: 10.000000<br />value: 0.1003157"],"type":"scatter","mode":"lines","name":"training","line":{"width":3.77952755905512,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","legendgroup":"training","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1.11392405063291,1.22784810126582,1.34177215189873,1.45569620253165,1.56962025316456,1.68354430379747,1.79746835443038,1.91139240506329,2.0253164556962,2.13924050632911,2.25316455696203,2.36708860759494,2.48101265822785,2.59493670886076,2.70886075949367,2.82278481012658,2.93670886075949,3.0506329113924,3.16455696202532,3.27848101265823,3.39240506329114,3.50632911392405,3.62025316455696,3.73417721518987,3.84810126582278,3.9620253164557,4.07594936708861,4.18987341772152,4.30379746835443,4.41772151898734,4.53164556962025,4.64556962025316,4.75949367088608,4.87341772151899,4.9873417721519,5.10126582278481,5.21518987341772,5.32911392405063,5.44303797468354,5.55696202531646,5.67088607594937,5.78481012658228,5.89873417721519,6.0126582278481,6.12658227848101,6.24050632911392,6.35443037974684,6.46835443037975,6.58227848101266,6.69620253164557,6.81012658227848,6.92405063291139,7.0379746835443,7.15189873417722,7.26582278481013,7.37974683544304,7.49367088607595,7.60759493670886,7.72151898734177,7.83544303797468,7.94936708860759,8.0632911392405,8.17721518987342,8.29113924050633,8.40506329113924,8.51898734177215,8.63291139240506,8.74683544303797,8.86075949367089,8.9746835443038,9.08860759493671,9.20253164556962,9.31645569620253,9.43037974683544,9.54430379746835,9.65822784810127,9.77215189873418,9.88607594936709,10],"y":[0.796485358883217,0.805270720650447,0.813743526862838,0.821907569619792,0.829766641020712,0.837324533165002,0.844585038152063,0.851551948081299,0.858229055052112,0.864617968178731,0.870667393515983,0.876370273592623,0.881748074446047,0.88682226211365,0.891614302632828,0.896145662040976,0.90043780637549,0.904512201673766,0.908326506906024,0.911459974323053,0.913944376273348,0.915917149203912,0.917515729561748,0.918877553793858,0.920140058347246,0.921440679668915,0.922916854205868,0.924572371818299,0.926062799768491,0.927391425168266,0.928593046065043,0.929702460506239,0.930754466539275,0.931783862211569,0.93282544557054,0.933914014663607,0.934985184809311,0.935920953656729,0.93675041333345,0.937504197127743,0.938212938327872,0.938907270222104,0.939617826098705,0.940375239245942,0.941209633777375,0.942094339654452,0.94299400851917,0.94390081463127,0.944806932250492,0.945704535636576,0.946585799049263,0.947442896748293,0.948268002993407,0.949054565677512,0.949814259191533,0.950553548890462,0.951274541321634,0.951979343032382,0.952670060570041,0.953348800481945,0.954017669315429,0.954678773617826,0.955332509043759,0.955972021290333,0.956596691010741,0.957206938308736,0.957803183288071,0.958385846052498,0.958955346705772,0.959512105351644,0.960056542093866,0.96058855588098,0.961107233243885,0.961612623628341,0.962104816300444,0.962583900526291,0.963049965571978,0.963503100703603,0.963943395187262,0.964370938289053],"text":["data: training<br />data: training<br />epoch:  1.000000<br />value: 0.7964854","data: training<br />data: training<br />epoch:  1.113924<br />value: 0.8052707","data: training<br />data: training<br />epoch:  1.227848<br />value: 0.8137435","data: training<br />data: training<br />epoch:  1.341772<br />value: 0.8219076","data: training<br />data: training<br />epoch:  1.455696<br />value: 0.8297666","data: training<br />data: training<br />epoch:  1.569620<br />value: 0.8373245","data: training<br />data: training<br />epoch:  1.683544<br />value: 0.8445850","data: training<br />data: training<br />epoch:  1.797468<br />value: 0.8515519","data: training<br />data: training<br />epoch:  1.911392<br />value: 0.8582291","data: training<br />data: training<br />epoch:  2.025316<br />value: 0.8646180","data: training<br />data: training<br />epoch:  2.139241<br />value: 0.8706674","data: training<br />data: training<br />epoch:  2.253165<br />value: 0.8763703","data: training<br />data: training<br />epoch:  2.367089<br />value: 0.8817481","data: training<br />data: training<br />epoch:  2.481013<br />value: 0.8868223","data: training<br />data: training<br />epoch:  2.594937<br />value: 0.8916143","data: training<br />data: training<br />epoch:  2.708861<br />value: 0.8961457","data: training<br />data: training<br />epoch:  2.822785<br />value: 0.9004378","data: training<br />data: training<br />epoch:  2.936709<br />value: 0.9045122","data: training<br />data: training<br />epoch:  3.050633<br />value: 0.9083265","data: training<br />data: training<br />epoch:  3.164557<br />value: 0.9114600","data: training<br />data: training<br />epoch:  3.278481<br />value: 0.9139444","data: training<br />data: training<br />epoch:  3.392405<br />value: 0.9159171","data: training<br />data: training<br />epoch:  3.506329<br />value: 0.9175157","data: training<br />data: training<br />epoch:  3.620253<br />value: 0.9188776","data: training<br />data: training<br />epoch:  3.734177<br />value: 0.9201401","data: training<br />data: training<br />epoch:  3.848101<br />value: 0.9214407","data: training<br />data: training<br />epoch:  3.962025<br />value: 0.9229169","data: training<br />data: training<br />epoch:  4.075949<br />value: 0.9245724","data: training<br />data: training<br />epoch:  4.189873<br />value: 0.9260628","data: training<br />data: training<br />epoch:  4.303797<br />value: 0.9273914","data: training<br />data: training<br />epoch:  4.417722<br />value: 0.9285930","data: training<br />data: training<br />epoch:  4.531646<br />value: 0.9297025","data: training<br />data: training<br />epoch:  4.645570<br />value: 0.9307545","data: training<br />data: training<br />epoch:  4.759494<br />value: 0.9317839","data: training<br />data: training<br />epoch:  4.873418<br />value: 0.9328254","data: training<br />data: training<br />epoch:  4.987342<br />value: 0.9339140","data: training<br />data: training<br />epoch:  5.101266<br />value: 0.9349852","data: training<br />data: training<br />epoch:  5.215190<br />value: 0.9359210","data: training<br />data: training<br />epoch:  5.329114<br />value: 0.9367504","data: training<br />data: training<br />epoch:  5.443038<br />value: 0.9375042","data: training<br />data: training<br />epoch:  5.556962<br />value: 0.9382129","data: training<br />data: training<br />epoch:  5.670886<br />value: 0.9389073","data: training<br />data: training<br />epoch:  5.784810<br />value: 0.9396178","data: training<br />data: training<br />epoch:  5.898734<br />value: 0.9403752","data: training<br />data: training<br />epoch:  6.012658<br />value: 0.9412096","data: training<br />data: training<br />epoch:  6.126582<br />value: 0.9420943","data: training<br />data: training<br />epoch:  6.240506<br />value: 0.9429940","data: training<br />data: training<br />epoch:  6.354430<br />value: 0.9439008","data: training<br />data: training<br />epoch:  6.468354<br />value: 0.9448069","data: training<br />data: training<br />epoch:  6.582278<br />value: 0.9457045","data: training<br />data: training<br />epoch:  6.696203<br />value: 0.9465858","data: training<br />data: training<br />epoch:  6.810127<br />value: 0.9474429","data: training<br />data: training<br />epoch:  6.924051<br />value: 0.9482680","data: training<br />data: training<br />epoch:  7.037975<br />value: 0.9490546","data: training<br />data: training<br />epoch:  7.151899<br />value: 0.9498143","data: training<br />data: training<br />epoch:  7.265823<br />value: 0.9505535","data: training<br />data: training<br />epoch:  7.379747<br />value: 0.9512745","data: training<br />data: training<br />epoch:  7.493671<br />value: 0.9519793","data: training<br />data: training<br />epoch:  7.607595<br />value: 0.9526701","data: training<br />data: training<br />epoch:  7.721519<br />value: 0.9533488","data: training<br />data: training<br />epoch:  7.835443<br />value: 0.9540177","data: training<br />data: training<br />epoch:  7.949367<br />value: 0.9546788","data: training<br />data: training<br />epoch:  8.063291<br />value: 0.9553325","data: training<br />data: training<br />epoch:  8.177215<br />value: 0.9559720","data: training<br />data: training<br />epoch:  8.291139<br />value: 0.9565967","data: training<br />data: training<br />epoch:  8.405063<br />value: 0.9572069","data: training<br />data: training<br />epoch:  8.518987<br />value: 0.9578032","data: training<br />data: training<br />epoch:  8.632911<br />value: 0.9583858","data: training<br />data: training<br />epoch:  8.746835<br />value: 0.9589553","data: training<br />data: training<br />epoch:  8.860759<br />value: 0.9595121","data: training<br />data: training<br />epoch:  8.974684<br />value: 0.9600565","data: training<br />data: training<br />epoch:  9.088608<br />value: 0.9605886","data: training<br />data: training<br />epoch:  9.202532<br />value: 0.9611072","data: training<br />data: training<br />epoch:  9.316456<br />value: 0.9616126","data: training<br />data: training<br />epoch:  9.430380<br />value: 0.9621048","data: training<br />data: training<br />epoch:  9.544304<br />value: 0.9625839","data: training<br />data: training<br />epoch:  9.658228<br />value: 0.9630500","data: training<br />data: training<br />epoch:  9.772152<br />value: 0.9635031","data: training<br />data: training<br />epoch:  9.886076<br />value: 0.9639434","data: training<br />data: training<br />epoch: 10.000000<br />value: 0.9643709"],"type":"scatter","mode":"lines","name":"training","line":{"width":3.77952755905512,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","legendgroup":"training","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,1.11392405063291,1.22784810126582,1.34177215189873,1.45569620253165,1.56962025316456,1.68354430379747,1.79746835443038,1.91139240506329,2.0253164556962,2.13924050632911,2.25316455696203,2.36708860759494,2.48101265822785,2.59493670886076,2.70886075949367,2.82278481012658,2.93670886075949,3.0506329113924,3.16455696202532,3.27848101265823,3.39240506329114,3.50632911392405,3.62025316455696,3.73417721518987,3.84810126582278,3.9620253164557,4.07594936708861,4.18987341772152,4.30379746835443,4.41772151898734,4.53164556962025,4.64556962025316,4.75949367088608,4.87341772151899,4.9873417721519,5.10126582278481,5.21518987341772,5.32911392405063,5.44303797468354,5.55696202531646,5.67088607594937,5.78481012658228,5.89873417721519,6.0126582278481,6.12658227848101,6.24050632911392,6.35443037974684,6.46835443037975,6.58227848101266,6.69620253164557,6.81012658227848,6.92405063291139,7.0379746835443,7.15189873417722,7.26582278481013,7.37974683544304,7.49367088607595,7.60759493670886,7.72151898734177,7.83544303797468,7.94936708860759,8.0632911392405,8.17721518987342,8.29113924050633,8.40506329113924,8.51898734177215,8.63291139240506,8.74683544303797,8.86075949367089,8.9746835443038,9.08860759493671,9.20253164556962,9.31645569620253,9.43037974683544,9.54430379746835,9.65822784810127,9.77215189873418,9.88607594936709,10],"y":[0.330125587261784,0.319607478313318,0.309582196660335,0.300050190326966,0.291011907337344,0.2824677957156,0.274418303485865,0.266863878672271,0.259804969298949,0.253244762614411,0.247251056521591,0.241831511802106,0.236957279976187,0.232599512564062,0.228729361085962,0.225317977062117,0.222336512012757,0.219756117458112,0.217614468102082,0.216348060760122,0.215929051996915,0.216220073612522,0.217083757407008,0.218382735180436,0.219979638732869,0.221737099864369,0.223517750375001,0.225663774602768,0.229435341326529,0.234473631889478,0.240293499149543,0.246409795964651,0.252337375192729,0.257591089691704,0.261685792319504,0.264136335934057,0.265376532499917,0.26654766686999,0.267571036383961,0.268354388069694,0.268805468955054,0.268832026067904,0.268341806436108,0.26724255708753,0.26543192546837,0.261962131217217,0.256618385310557,0.249911716451756,0.242353153344185,0.234453724691211,0.226724459196203,0.21967638556253,0.21382053249356,0.209548603636649,0.205689508785375,0.201867935226494,0.198153147175414,0.194614408847539,0.191320984458275,0.188342138223029,0.185747134357206,0.183605237076211,0.181932546454439,0.180517336705189,0.17933807396804,0.178405316734075,0.177729623494377,0.17732155274003,0.177191662962118,0.177350512651722,0.177808660299927,0.17856301595382,0.17958916651453,0.18088787510743,0.182460946973374,0.184310187353216,0.186437401487812,0.188844394618014,0.191532971984678,0.194504938828657],"text":["data: validation<br />data: validation<br />epoch:  1.000000<br />value: 0.3301256","data: validation<br />data: validation<br />epoch:  1.113924<br />value: 0.3196075","data: validation<br />data: validation<br />epoch:  1.227848<br />value: 0.3095822","data: validation<br />data: validation<br />epoch:  1.341772<br />value: 0.3000502","data: validation<br />data: validation<br />epoch:  1.455696<br />value: 0.2910119","data: validation<br />data: validation<br />epoch:  1.569620<br />value: 0.2824678","data: validation<br />data: validation<br />epoch:  1.683544<br />value: 0.2744183","data: validation<br />data: validation<br />epoch:  1.797468<br />value: 0.2668639","data: validation<br />data: validation<br />epoch:  1.911392<br />value: 0.2598050","data: validation<br />data: validation<br />epoch:  2.025316<br />value: 0.2532448","data: validation<br />data: validation<br />epoch:  2.139241<br />value: 0.2472511","data: validation<br />data: validation<br />epoch:  2.253165<br />value: 0.2418315","data: validation<br />data: validation<br />epoch:  2.367089<br />value: 0.2369573","data: validation<br />data: validation<br />epoch:  2.481013<br />value: 0.2325995","data: validation<br />data: validation<br />epoch:  2.594937<br />value: 0.2287294","data: validation<br />data: validation<br />epoch:  2.708861<br />value: 0.2253180","data: validation<br />data: validation<br />epoch:  2.822785<br />value: 0.2223365","data: validation<br />data: validation<br />epoch:  2.936709<br />value: 0.2197561","data: validation<br />data: validation<br />epoch:  3.050633<br />value: 0.2176145","data: validation<br />data: validation<br />epoch:  3.164557<br />value: 0.2163481","data: validation<br />data: validation<br />epoch:  3.278481<br />value: 0.2159291","data: validation<br />data: validation<br />epoch:  3.392405<br />value: 0.2162201","data: validation<br />data: validation<br />epoch:  3.506329<br />value: 0.2170838","data: validation<br />data: validation<br />epoch:  3.620253<br />value: 0.2183827","data: validation<br />data: validation<br />epoch:  3.734177<br />value: 0.2199796","data: validation<br />data: validation<br />epoch:  3.848101<br />value: 0.2217371","data: validation<br />data: validation<br />epoch:  3.962025<br />value: 0.2235178","data: validation<br />data: validation<br />epoch:  4.075949<br />value: 0.2256638","data: validation<br />data: validation<br />epoch:  4.189873<br />value: 0.2294353","data: validation<br />data: validation<br />epoch:  4.303797<br />value: 0.2344736","data: validation<br />data: validation<br />epoch:  4.417722<br />value: 0.2402935","data: validation<br />data: validation<br />epoch:  4.531646<br />value: 0.2464098","data: validation<br />data: validation<br />epoch:  4.645570<br />value: 0.2523374","data: validation<br />data: validation<br />epoch:  4.759494<br />value: 0.2575911","data: validation<br />data: validation<br />epoch:  4.873418<br />value: 0.2616858","data: validation<br />data: validation<br />epoch:  4.987342<br />value: 0.2641363","data: validation<br />data: validation<br />epoch:  5.101266<br />value: 0.2653765","data: validation<br />data: validation<br />epoch:  5.215190<br />value: 0.2665477","data: validation<br />data: validation<br />epoch:  5.329114<br />value: 0.2675710","data: validation<br />data: validation<br />epoch:  5.443038<br />value: 0.2683544","data: validation<br />data: validation<br />epoch:  5.556962<br />value: 0.2688055","data: validation<br />data: validation<br />epoch:  5.670886<br />value: 0.2688320","data: validation<br />data: validation<br />epoch:  5.784810<br />value: 0.2683418","data: validation<br />data: validation<br />epoch:  5.898734<br />value: 0.2672426","data: validation<br />data: validation<br />epoch:  6.012658<br />value: 0.2654319","data: validation<br />data: validation<br />epoch:  6.126582<br />value: 0.2619621","data: validation<br />data: validation<br />epoch:  6.240506<br />value: 0.2566184","data: validation<br />data: validation<br />epoch:  6.354430<br />value: 0.2499117","data: validation<br />data: validation<br />epoch:  6.468354<br />value: 0.2423532","data: validation<br />data: validation<br />epoch:  6.582278<br />value: 0.2344537","data: validation<br />data: validation<br />epoch:  6.696203<br />value: 0.2267245","data: validation<br />data: validation<br />epoch:  6.810127<br />value: 0.2196764","data: validation<br />data: validation<br />epoch:  6.924051<br />value: 0.2138205","data: validation<br />data: validation<br />epoch:  7.037975<br />value: 0.2095486","data: validation<br />data: validation<br />epoch:  7.151899<br />value: 0.2056895","data: validation<br />data: validation<br />epoch:  7.265823<br />value: 0.2018679","data: validation<br />data: validation<br />epoch:  7.379747<br />value: 0.1981531","data: validation<br />data: validation<br />epoch:  7.493671<br />value: 0.1946144","data: validation<br />data: validation<br />epoch:  7.607595<br />value: 0.1913210","data: validation<br />data: validation<br />epoch:  7.721519<br />value: 0.1883421","data: validation<br />data: validation<br />epoch:  7.835443<br />value: 0.1857471","data: validation<br />data: validation<br />epoch:  7.949367<br />value: 0.1836052","data: validation<br />data: validation<br />epoch:  8.063291<br />value: 0.1819325","data: validation<br />data: validation<br />epoch:  8.177215<br />value: 0.1805173","data: validation<br />data: validation<br />epoch:  8.291139<br />value: 0.1793381","data: validation<br />data: validation<br />epoch:  8.405063<br />value: 0.1784053","data: validation<br />data: validation<br />epoch:  8.518987<br />value: 0.1777296","data: validation<br />data: validation<br />epoch:  8.632911<br />value: 0.1773216","data: validation<br />data: validation<br />epoch:  8.746835<br />value: 0.1771917","data: validation<br />data: validation<br />epoch:  8.860759<br />value: 0.1773505","data: validation<br />data: validation<br />epoch:  8.974684<br />value: 0.1778087","data: validation<br />data: validation<br />epoch:  9.088608<br />value: 0.1785630","data: validation<br />data: validation<br />epoch:  9.202532<br />value: 0.1795892","data: validation<br />data: validation<br />epoch:  9.316456<br />value: 0.1808879","data: validation<br />data: validation<br />epoch:  9.430380<br />value: 0.1824609","data: validation<br />data: validation<br />epoch:  9.544304<br />value: 0.1843102","data: validation<br />data: validation<br />epoch:  9.658228<br />value: 0.1864374","data: validation<br />data: validation<br />epoch:  9.772152<br />value: 0.1888444","data: validation<br />data: validation<br />epoch:  9.886076<br />value: 0.1915330","data: validation<br />data: validation<br />epoch: 10.000000<br />value: 0.1945049"],"type":"scatter","mode":"lines","name":"validation","line":{"width":3.77952755905512,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","legendgroup":"validation","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1.11392405063291,1.22784810126582,1.34177215189873,1.45569620253165,1.56962025316456,1.68354430379747,1.79746835443038,1.91139240506329,2.0253164556962,2.13924050632911,2.25316455696203,2.36708860759494,2.48101265822785,2.59493670886076,2.70886075949367,2.82278481012658,2.93670886075949,3.0506329113924,3.16455696202532,3.27848101265823,3.39240506329114,3.50632911392405,3.62025316455696,3.73417721518987,3.84810126582278,3.9620253164557,4.07594936708861,4.18987341772152,4.30379746835443,4.41772151898734,4.53164556962025,4.64556962025316,4.75949367088608,4.87341772151899,4.9873417721519,5.10126582278481,5.21518987341772,5.32911392405063,5.44303797468354,5.55696202531646,5.67088607594937,5.78481012658228,5.89873417721519,6.0126582278481,6.12658227848101,6.24050632911392,6.35443037974684,6.46835443037975,6.58227848101266,6.69620253164557,6.81012658227848,6.92405063291139,7.0379746835443,7.15189873417722,7.26582278481013,7.37974683544304,7.49367088607595,7.60759493670886,7.72151898734177,7.83544303797468,7.94936708860759,8.0632911392405,8.17721518987342,8.29113924050633,8.40506329113924,8.51898734177215,8.63291139240506,8.74683544303797,8.86075949367089,8.9746835443038,9.08860759493671,9.20253164556962,9.31645569620253,9.43037974683544,9.54430379746835,9.65822784810127,9.77215189873418,9.88607594936709,10],"y":[0.860622264117301,0.865797689384292,0.870731451359269,0.87542361748785,0.879874255215653,0.884083431988294,0.888051215251392,0.891777672450564,0.895262871031426,0.898505233609389,0.90146429577384,0.904135468595045,0.906536049491678,0.908683335882411,0.910594625185918,0.912287214820873,0.913778402205949,0.915085484759818,0.916186171434668,0.916820636648328,0.917005054936341,0.916820751419196,0.916349051217384,0.915671279451394,0.914868761241716,0.91402282170884,0.913214785973254,0.912287546233049,0.910615376206956,0.908363846648482,0.905760850765578,0.903034281766191,0.900412032858273,0.898121997249771,0.896392068148636,0.895450138762816,0.895143500543364,0.894991478826841,0.894994970120161,0.895160362059909,0.895494042282669,0.896002398425027,0.896691818123566,0.897568689014871,0.898645181745836,0.900436629466883,0.903100065103432,0.906389124770204,0.910057444581916,0.913858660653288,0.917546409099037,0.920874326033883,0.923596047572543,0.925515360555295,0.927113335570827,0.928580071141463,0.929923931647731,0.931153281470157,0.932276484989267,0.933301906585588,0.934237910639644,0.935092861531964,0.935867471611851,0.936530917519553,0.937081506145263,0.937522266013102,0.937856225647194,0.938086413571659,0.938215858310618,0.938247588388194,0.938184632328508,0.93802640045451,0.937766250204383,0.937403859999206,0.936939178272885,0.936372153459321,0.93570273399242,0.934930868306086,0.934056504834222,0.933079592010732],"text":["data: validation<br />data: validation<br />epoch:  1.000000<br />value: 0.8606223","data: validation<br />data: validation<br />epoch:  1.113924<br />value: 0.8657977","data: validation<br />data: validation<br />epoch:  1.227848<br />value: 0.8707315","data: validation<br />data: validation<br />epoch:  1.341772<br />value: 0.8754236","data: validation<br />data: validation<br />epoch:  1.455696<br />value: 0.8798743","data: validation<br />data: validation<br />epoch:  1.569620<br />value: 0.8840834","data: validation<br />data: validation<br />epoch:  1.683544<br />value: 0.8880512","data: validation<br />data: validation<br />epoch:  1.797468<br />value: 0.8917777","data: validation<br />data: validation<br />epoch:  1.911392<br />value: 0.8952629","data: validation<br />data: validation<br />epoch:  2.025316<br />value: 0.8985052","data: validation<br />data: validation<br />epoch:  2.139241<br />value: 0.9014643","data: validation<br />data: validation<br />epoch:  2.253165<br />value: 0.9041355","data: validation<br />data: validation<br />epoch:  2.367089<br />value: 0.9065360","data: validation<br />data: validation<br />epoch:  2.481013<br />value: 0.9086833","data: validation<br />data: validation<br />epoch:  2.594937<br />value: 0.9105946","data: validation<br />data: validation<br />epoch:  2.708861<br />value: 0.9122872","data: validation<br />data: validation<br />epoch:  2.822785<br />value: 0.9137784","data: validation<br />data: validation<br />epoch:  2.936709<br />value: 0.9150855","data: validation<br />data: validation<br />epoch:  3.050633<br />value: 0.9161862","data: validation<br />data: validation<br />epoch:  3.164557<br />value: 0.9168206","data: validation<br />data: validation<br />epoch:  3.278481<br />value: 0.9170051","data: validation<br />data: validation<br />epoch:  3.392405<br />value: 0.9168208","data: validation<br />data: validation<br />epoch:  3.506329<br />value: 0.9163491","data: validation<br />data: validation<br />epoch:  3.620253<br />value: 0.9156713","data: validation<br />data: validation<br />epoch:  3.734177<br />value: 0.9148688","data: validation<br />data: validation<br />epoch:  3.848101<br />value: 0.9140228","data: validation<br />data: validation<br />epoch:  3.962025<br />value: 0.9132148","data: validation<br />data: validation<br />epoch:  4.075949<br />value: 0.9122875","data: validation<br />data: validation<br />epoch:  4.189873<br />value: 0.9106154","data: validation<br />data: validation<br />epoch:  4.303797<br />value: 0.9083638","data: validation<br />data: validation<br />epoch:  4.417722<br />value: 0.9057609","data: validation<br />data: validation<br />epoch:  4.531646<br />value: 0.9030343","data: validation<br />data: validation<br />epoch:  4.645570<br />value: 0.9004120","data: validation<br />data: validation<br />epoch:  4.759494<br />value: 0.8981220","data: validation<br />data: validation<br />epoch:  4.873418<br />value: 0.8963921","data: validation<br />data: validation<br />epoch:  4.987342<br />value: 0.8954501","data: validation<br />data: validation<br />epoch:  5.101266<br />value: 0.8951435","data: validation<br />data: validation<br />epoch:  5.215190<br />value: 0.8949915","data: validation<br />data: validation<br />epoch:  5.329114<br />value: 0.8949950","data: validation<br />data: validation<br />epoch:  5.443038<br />value: 0.8951604","data: validation<br />data: validation<br />epoch:  5.556962<br />value: 0.8954940","data: validation<br />data: validation<br />epoch:  5.670886<br />value: 0.8960024","data: validation<br />data: validation<br />epoch:  5.784810<br />value: 0.8966918","data: validation<br />data: validation<br />epoch:  5.898734<br />value: 0.8975687","data: validation<br />data: validation<br />epoch:  6.012658<br />value: 0.8986452","data: validation<br />data: validation<br />epoch:  6.126582<br />value: 0.9004366","data: validation<br />data: validation<br />epoch:  6.240506<br />value: 0.9031001","data: validation<br />data: validation<br />epoch:  6.354430<br />value: 0.9063891","data: validation<br />data: validation<br />epoch:  6.468354<br />value: 0.9100574","data: validation<br />data: validation<br />epoch:  6.582278<br />value: 0.9138587","data: validation<br />data: validation<br />epoch:  6.696203<br />value: 0.9175464","data: validation<br />data: validation<br />epoch:  6.810127<br />value: 0.9208743","data: validation<br />data: validation<br />epoch:  6.924051<br />value: 0.9235960","data: validation<br />data: validation<br />epoch:  7.037975<br />value: 0.9255154","data: validation<br />data: validation<br />epoch:  7.151899<br />value: 0.9271133","data: validation<br />data: validation<br />epoch:  7.265823<br />value: 0.9285801","data: validation<br />data: validation<br />epoch:  7.379747<br />value: 0.9299239","data: validation<br />data: validation<br />epoch:  7.493671<br />value: 0.9311533","data: validation<br />data: validation<br />epoch:  7.607595<br />value: 0.9322765","data: validation<br />data: validation<br />epoch:  7.721519<br />value: 0.9333019","data: validation<br />data: validation<br />epoch:  7.835443<br />value: 0.9342379","data: validation<br />data: validation<br />epoch:  7.949367<br />value: 0.9350929","data: validation<br />data: validation<br />epoch:  8.063291<br />value: 0.9358675","data: validation<br />data: validation<br />epoch:  8.177215<br />value: 0.9365309","data: validation<br />data: validation<br />epoch:  8.291139<br />value: 0.9370815","data: validation<br />data: validation<br />epoch:  8.405063<br />value: 0.9375223","data: validation<br />data: validation<br />epoch:  8.518987<br />value: 0.9378562","data: validation<br />data: validation<br />epoch:  8.632911<br />value: 0.9380864","data: validation<br />data: validation<br />epoch:  8.746835<br />value: 0.9382159","data: validation<br />data: validation<br />epoch:  8.860759<br />value: 0.9382476","data: validation<br />data: validation<br />epoch:  8.974684<br />value: 0.9381846","data: validation<br />data: validation<br />epoch:  9.088608<br />value: 0.9380264","data: validation<br />data: validation<br />epoch:  9.202532<br />value: 0.9377663","data: validation<br />data: validation<br />epoch:  9.316456<br />value: 0.9374039","data: validation<br />data: validation<br />epoch:  9.430380<br />value: 0.9369392","data: validation<br />data: validation<br />epoch:  9.544304<br />value: 0.9363722","data: validation<br />data: validation<br />epoch:  9.658228<br />value: 0.9357027","data: validation<br />data: validation<br />epoch:  9.772152<br />value: 0.9349309","data: validation<br />data: validation<br />epoch:  9.886076<br />value: 0.9340565","data: validation<br />data: validation<br />epoch: 10.000000<br />value: 0.9330796"],"type":"scatter","mode":"lines","name":"validation","line":{"width":3.77952755905512,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","legendgroup":"validation","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.8401826484018,"r":21.9178082191781,"b":40.1826484018265,"l":28.4931506849315},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.55,10.45],"tickmode":"array","ticktext":["2","4","6","8","10"],"tickvals":[2,4,6,8,10],"categoryorder":"array","categoryarray":["2","4","6","8","10"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y2","title":"","hoverformat":".2f"},"annotations":[{"text":"epoch","x":0.5,"y":-0.0471841704718417,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis"},{"text":"loss","x":1,"y":0.757610350076104,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"accuracy","x":1,"y":0.242389649923896,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"data","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"yaxis":{"domain":[0.515220700152207,1],"automargin":true,"type":"linear","autorange":false,"range":[0.0816780716180801,0.467396101355553],"tickmode":"array","ticktext":["0.1","0.2","0.3","0.4"],"tickvals":[0.1,0.2,0.3,0.4],"categoryorder":"array","categoryarray":["0.1","0.2","0.3","0.4"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.515220700152207,"y1":1},{"type":"rect","fillcolor":"transparent","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.515220700152207,"y1":1,"x0":0,"x1":26.3013698630137,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":0.484779299847793},{"type":"rect","fillcolor":"transparent","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0,"y1":0.484779299847793,"x0":0,"x1":26.3013698630137,"xanchor":1,"xsizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":false,"range":[0.780761027336121,0.973264908790588],"tickmode":"array","ticktext":["0.80","0.85","0.90","0.95"],"tickvals":[0.8,0.85,0.9,0.95],"categoryorder":"array","categoryarray":["0.80","0.85","0.90","0.95"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.484779299847793],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.913385826771654},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"1140b3958b243":{"colour":{},"fill":{},"x":{},"y":{},"type":"scatter"},"1140b6e1f6a1e":{"colour":{},"fill":{},"x":{},"y":{}}},"cur_data":"1140b3958b243","visdat":{"1140b3958b243":["function (y) ","x"],"1140b6e1f6a1e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="save" class="section level2">
<h2>Save</h2>
<p>For some reason before using the model for prediction on my machine I need to save it and load it each time.</p>
<pre class="r"><code>save_model_hdf5(model, paste0(path,&quot;/tf_models/binary_gray_img_classification&quot;))</code></pre>
</div>
</div>
<div id="evaluation" class="section level1">
<h1>Evaluation</h1>
<div id="model-accuracy" class="section level2">
<h2>Model Accuracy</h2>
<p>We saw from the training history plot that the prediction accuracy was ~94%. We can rectreate this and then go a little bit deeper in evaluating the model usng a simple confusion matrix.</p>
<p>First lets get the predicted labels:</p>
<pre class="r"><code>smodel = load_model_hdf5(paste0(path,&quot;/tf_models/binary_gray_img_classification&quot;), compile = TRUE)


tpred = vector(mode = &quot;character&quot;, length = dim(X_test)[1])
for(i in 1:dim(X_test)[1]){
  #pick the lable with the max predicted probability
  tpred[i] =  c(&quot;city/building&quot;,&quot;nature&quot;)[which.max(smodel %&gt;% predict(X_test[i, , , ,drop = FALSE]))]
}


conf = table(tpred, test_labels)/length(tpred)
round(conf,2)</code></pre>
<pre><code>##                test_labels
## tpred           city/building nature
##   city/building          0.26   0.02
##   nature                 0.05   0.67</code></pre>
<p>Looking at the confusion matrix above we see that 28% of the time we predict a <code>city/building</code> label and 73% of the time we predict a <code>nature</code> label. We can tell by summing the diagonal that the overall accuracy is indeed 94%, yet we also see that our model struggles more with correctly identifying a <code>city/building</code> image.</p>
<p>this is the probability of predicting <code>nature</code> while the true label is <code>city/building</code>.
<span class="math display">\[ P(Nature|City) = 0.05/0.28 = 18\% \]</span>
on the other hand the likelihood of making the opposite error is</p>
<p><span class="math display">\[ P(City|Nature) = 0.01/0.73 = 1.4\% \]</span>
Essentially the model likes to play it safe and predict nature more often. When we look to validate the model it will be much more likely to falsely classify an image of a <code>building/city</code> as <code>nature</code></p>
</div>
<div id="examples-of-miss-classification" class="section level2">
<h2>Examples of Miss-Classification</h2>
<p>Going one more step further we can look at actual examples where the model made a mistake, and see how sure or unsure it was about the prediction</p>
<pre class="r"><code>smodel = load_model_hdf5(paste0(path,&quot;/tf_models/binary_gray_img_classification&quot;), compile = TRUE)

fi = which(tpred != test_labels)
par(mfrow = c(4,4), mar = c(1,1,1,1))
set.seed(123)
ri = sample(fi, 16)

for(i in ri){
  propbs = smodel %&gt;% predict(X_test[i, , , ,drop = FALSE])
  lab = str_c(c(&quot;city/building&quot;,&quot;nature&quot;), round(propbs,2), sep = &quot;:&quot;, collapse = &quot; / &quot;)
  as.cimg(X_test[i, , , ]) %&gt;% imrotate(90) %&gt;% plot(axes = FALSE, main = tpred[i])
  text(75, 130, labels = lab, col = 2, cex = 1)
}</code></pre>
<p><img src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="validation-on-unseen-images" class="section level2">
<h2>Validation on Unseen Images</h2>
<pre class="r"><code>val_image_files = list.files(paste0(path,&quot;/data/seg_pred/seg_pred&quot;), recursive = TRUE, full.names = TRUE)

val_data = map(val_image_files[1:400],
                ~image_load(.x, target_size = c(150,150), grayscale = TRUE) %&gt;%
                  image_to_array() %&gt;%
                  magrittr::divide_by(255)
)

X_val = array(unlist(val_data), dim = c(150, 150, 1, length(val_data))) %&gt;% aperm(c(4,1,2,3))

par(mfrow = c(2,2), mar = c(1,1,1,1))
as.cimg(X_val[1, , , ]) %&gt;% imrotate(90) %&gt;% plot(axes = FALSE)
as.cimg(X_val[2, , , ]) %&gt;% imrotate(90) %&gt;% plot(axes = FALSE)
as.cimg(X_val[3, , , ]) %&gt;% imrotate(90) %&gt;% plot(axes = FALSE)
as.cimg(X_val[4, , , ]) %&gt;% imrotate(90) %&gt;% plot(axes = FALSE)</code></pre>
<p><img src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>smodel = load_model_hdf5(paste0(path,&quot;/tf_models/binary_gray_img_classification&quot;), compile = TRUE)

vpred = vector(mode = &quot;character&quot;, length = dim(X_val)[1])
for(i in 1:dim(X_val)[1]){
  vpred[i] = c(&quot;city/building&quot;,&quot;nature&quot;)[which.max(smodel %&gt;% predict(X_val[i, , , ,drop = FALSE]))]
}</code></pre>
<pre class="r"><code>set.seed(123)

par(mfrow = c(4,4), mar = c(1,1,1,1))
ri = sample(1:length(vpred), 16)
map(ri, ~ as.cimg(X_val[.x, , , ]) %&gt;% imrotate(90) %&gt;% plot(axes = FALSE, main = vpred[.x]))</code></pre>
<p><img src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre><code>## [[1]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[2]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[3]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[4]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[5]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[6]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[7]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[8]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[9]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[10]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[11]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[12]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[13]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[14]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[15]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[16]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1</code></pre>
</div>
</div>



                </div>

                
            </div>
        </div>
    </div>
</div>

<section id="comments">
    <div class="py-3 content">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-sm-12 col-lg-8">
                    <div class="comments">
                        <script src="https://utteranc.es/client.js" repo=""
                            issue-term="pathname" label="comment" theme="github-light" crossorigin="anonymous" async>
                            </script>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>



    

    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js" defer></script>
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/python.min.js" defer></script>
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/stan.min.js" defer></script>
        
        <script>
            window.addEventListener('load', function() {
                hljs.initHighlighting();
            }, true);
        </script>
    

    

    
    
        
<script src="https://bdshaff.github.io/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
</body>

</html>
