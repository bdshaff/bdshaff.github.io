<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> Binary Image Classification with Keras in R - Ben&#39;s Data Science </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta name="description" content="Description for the page" />
    <meta property="og:site_name" content="Ben&#39;s Data Science" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/" />
    <meta property="og:title" content="Binary Image Classification with Keras in R" />
    <meta property="og:image" content="https://bdshaff.github.io/images/image.png" />
    <meta property="og:description" content="Description for the page" />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:title" content="Binary Image Classification with Keras in R" />
    <meta name="twitter:description" content="Description for the page" />
    <meta name="twitter:image" content="https://bdshaff.github.io/images/image.png" />

    <link rel="canonical" href="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous" />

    <link rel="stylesheet" href="https://bdshaff.github.io/css/custom.css" />

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github-gist.min.css" integrity="sha512-od7JLoOTxM8w/HSKGzP9Kexc20K9p/M2zxSWsd7H1e4Ctf+8SQFtCWEZnW5u6ul5ehSECa5QmOk9ju2nQMmlVA==" crossorigin="anonymous" />
    

    

    <link rel="shortcut icon"
        href="https://bdshaff.github.io/images/favicon.png">

    
    <link href="https://bdshaff.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Ben&#39;s Data Science" />
    
</head>

<body>
    
<div class="mt-xl header">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-auto">
                <a href="https://bdshaff.github.io/">
                    <h1 class="name">Ben&#39;s Data Science</h1>
                </a>
            </div>
        </div>

        <div class="row justify-content-center">
            <ul class="nav nav-primary">
                
                <li class="nav-item">
                    <a class="nav-link" href="https://bdshaff.github.io/">
                        
                        Home
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://bdshaff.github.io/about/">
                        
                        About
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://github.com/bdshaff">
                        
                        GitHub
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://medium.com/@bdshaff">
                        
                        Medium
                    </a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link" href="https://www.linkedin.com/in/bendenisshaffer/">
                        
                        LinkedIn
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

<div class="content">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-sm-12 col-lg-8">
                <h1 class="mx-0 mx-md-4 blog-post-title">Binary Image Classification with Keras in R</h1>

                <div class="mb-md-4 meta">
                    
                    
                    <span class="author" title="Package Build">
                        Package Build
                    </span>
                    
                    

                    <span class="date middot" title='Mon May 31 2021 00:00:00 UTC'>
                        2021-05-31
                    </span>

                    <span class="reading-time middot">
                        20 min read
                    </span>

                    <div class="d-none d-md-inline tags">
                        <ul class="list-unstyled d-inline">
                            
                            <li class="d-inline middot">
                                <a href="https://bdshaff.github.io/tags/keras">Keras</a>
                            </li>
                            
                            <li class="d-inline middot">
                                <a href="https://bdshaff.github.io/tags/tensorflow">Tensorflow</a>
                            </li>
                            
                        </ul>
                    </div>
                </div>

                <div class="markdown blog-post-content">
                    
    
<script src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/header-attrs/header-attrs.js"></script>
<script src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/htmlwidgets/htmlwidgets.js"></script>
<script src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/plotly-binding/plotly.js"></script>
<script src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/typedarray/typedarray.min.js"></script>
<script src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/jquery/jquery.min.js"></script>
<link href="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/crosstalk/js/crosstalk.min.js"></script>
<link href="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/plotly-main/plotly-latest.min.js"></script>


<div id="binary-image-classification-with-keras-in-r-apple-m1-chip" class="section level1">
<h1>Binary Image Classification with Keras in R (Apple M1 Chip)</h1>
<p>This my first real exploration of the Keras and the use of CNNs for image classification. The exercise is done on hardware with an Apple M1 Chip and using R interface to Keras. This means that the versions of R, Python, TensorFlow and Keras are all versions that run natively on the M1 Chip. If you prefer to use R and use an M1 mac then here are a few useful links:</p>
<ul>
<li><p><a href="https://cran.r-project.org/bin/macosx/">R 4.1.0-arm64.pkg is the official release of R that runs natively on Apple silicon arm64.</a></p></li>
<li><p><a href="https://dailies.rstudio.com/rstudio/oss/mac/">Rstudio Daily Builds will work with this version of R</a>.</p></li>
<li><p><a href="https://github.com/conda-forge/miniforge#miniforge3">Miniforge3 for arm64 Python</a>.</p></li>
<li><p><a href="https://github.com/apple/tensorflow_macos">Version of TF that will run on M1</a>.</p></li>
<li><p><a href="https://medium.com/codex/installing-tensorflow-on-m1-macs-958767a7a4b3">A blog with instruction to setup TF and Python for M1 Chip</a>.</p></li>
</ul>
<p>To then make this available in R just need to use <code>reticulate::use_condaenv</code> and point to the environment where the Python and TF were setup.</p>
<pre class="r"><code>library(tensorflow)
library(keras)
library(purrr)
library(imager)
library(stringr)

reticulate::use_condaenv(&quot;~/miniforge3/envs/python38/&quot;)</code></pre>
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<p>For this exercise I am using a data-set from Kaggle which was used for the <a href="https://www.kaggle.com/puneet6060/intel-image-classification">Intel Image Classification competition.</a> The original task is a multiclass classification with building, street, forest, glacier, mountain, sea as labels. For my purposes I simplified the task to a binary classification and used gray-scale images even though colored images are available.</p>
<p>Here is the structure of the data in this project. building, Street are grouped to make a first class, and forest, glacier, mountain, sea are grouped to make the second class.</p>
<pre class="r"><code>fs::dir_tree(paste0(path, &quot;/data&quot;), recurse = 2, regexp = &quot;train|test&quot;)</code></pre>
<pre><code>## ~/Documents/Ben&#39;s Data Science/Intel Image Classifiction/data
## ├── test
## │   ├── city
## │   │   ├── buildings
## │   │   └── street
## │   └── nature
## │       ├── forest
## │       ├── glacier
## │       ├── mountain
## │       └── sea
## └── train
##     ├── city
##     │   ├── buildings
##     │   └── street
##     └── nature
##         ├── forest
##         ├── glacier
##         ├── mountain
##         └── sea</code></pre>
<div id="loading-image-data-in-r" class="section level2">
<h2>Loading Image Data in R</h2>
<p>There are a couple of ways to read in the images into R. One way is to use <code>imager::load.image</code> function. The advantage is that we get an object of class <code>cimg</code> which is easy to manipulate, plot, and cast to an array. For ML and for building models in Keras using <code>keras::image_load()</code> and <code>keras::image_to_array()</code> is more convenient because we can specify if we want to grayscale images and the target size. Images all need to be of the same dimension. We expect 150x150 images in this data, but some images are in fact of a different size and would need to be further processed or excluded. <code>keras::image_load()</code> very conveniently helps us take care of this issue.</p>
<pre class="r"><code>train_image_files = list.files(paste0(path,&quot;/data/train&quot;), recursive = TRUE, full.names = TRUE)
train_labels = map_chr(train_image_files, ~ifelse(str_detect(.x,&quot;city&quot;), &quot;city/building&quot;,&quot;nature&quot;))

y_train = to_categorical(as.numeric(as.factor(train_labels)), num_classes = 3)[,2:3]
y_train = to_categorical(as.numeric(as.factor(train_labels)), num_classes = 3)[,2:3]

test_image_files = list.files(paste0(path,&quot;/data/test&quot;), recursive = TRUE, full.names = TRUE)
test_labels = map_chr(test_image_files, ~ifelse(str_detect(.x,&quot;city&quot;), &quot;city/building&quot;,&quot;nature&quot;))

y_test = to_categorical(as.numeric(as.factor(test_labels)), num_classes = 3)[,2:3]</code></pre>
<pre class="r"><code>train_data = map(train_image_files, 
                ~image_load(.x, target_size = c(150,150), grayscale = TRUE) %&gt;% 
                  image_to_array() %&gt;% 
                  divide_by(255)
                )

test_data = map(test_image_files, 
                ~image_load(.x, target_size = c(150,150), grayscale = TRUE) %&gt;% 
                  image_to_array() %&gt;% 
                  divide_by(255)
                )</code></pre>
<p>When the data is loaded using <code>purrr::map</code> we get back a list of images. This is very convenient for certain use cases but for Keras we need to use <code>arrays</code> which are higher dimensional matrices. Thankfully it is not very difficult to restructure the data into one big array and give it the right dimensions using base R functions <code>array</code> <code>unlist</code> and <code>aperm</code>.</p>
<pre class="r"><code>X_test = array(unlist(test_data), dim = c(150, 150, 1, length(test_data))) %&gt;% aperm(c(4,1,2,3))
X_train = array(unlist(train_data), dim = c(150, 150, 1, length(train_data))) %&gt;% aperm(c(4,1,2,3))</code></pre>
</div>
<div id="sample-images" class="section level2">
<h2>Sample Images</h2>
<p>To visualize a sample image from either the test of train sets it is easy to simply slice the resultant array of data and cast back to <code>cimg</code>.</p>
<pre class="r"><code>par(mfrow = c(1,2), mar = c(1,1,1,1))
as.cimg(X_test[2000, , , ])  %&gt;% imrotate(90) %&gt;% plot(axes = FALSE, main = test_labels[2000])
as.cimg(X_train[1, , , ]) %&gt;% imrotate(90) %&gt;% plot(axes = FALSE, main = train_labels[1])</code></pre>
<p><img src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/figure-html/viz-img-example-1.png" width="672" /></p>
</div>
</div>
<div id="convolutional-neural-network" class="section level1">
<h1>Convolutional Neural Network</h1>
<div id="define-model" class="section level2">
<h2>Define Model</h2>
<p>Honestly, it is really amazing how simple it is to define and train models which are in fact really complicated models. The level of abstraction that Keras provides makes this model building process really enjoyable. Here I am defining an CNN with seven hidden layers. From the summary we can see that there are <code>120,442</code> parameters to train/estimate. In my mind this is still a parametric statistical model except one where the inferences about parameters are really of no practical use (yet). One parameter here may represent a very small area of an image filtered through multiple convolutions. This really is a statistical model for one function of an intellect. Perhaps understanding the parameters can help understand the intellect better - the more practical use for a model like this is to learn how to mimic an intellect.</p>
<pre class="r"><code>model = keras_model_sequential()
model %&gt;% 
  layer_conv_2d(120, kernel_size = 3, strides = 2, activation = &quot;relu&quot;, input_shape = c(150, 150, 1)) %&gt;%
  layer_max_pooling_2d(2) %&gt;%
  layer_conv_2d(60, kernel_size = 3, strides = 2, activation = &quot;relu&quot;) %&gt;%
  layer_conv_2d(60, kernel_size = 3, strides = 2, activation = &quot;relu&quot;) %&gt;%
  layer_max_pooling_2d(2) %&gt;%
  layer_conv_2d(40, kernel_size = 3, strides = 2, activation = &quot;relu&quot;) %&gt;%
  layer_flatten() %&gt;%
  layer_dense(2, activation = &quot;sigmoid&quot;)</code></pre>
<pre class="r"><code>summary(model)</code></pre>
<pre><code>## Model: &quot;sequential&quot;
## ________________________________________________________________________________
## Layer (type)                        Output Shape                    Param #     
## ================================================================================
## conv2d_3 (Conv2D)                   (None, 74, 74, 120)             1200        
## ________________________________________________________________________________
## max_pooling2d_1 (MaxPooling2D)      (None, 37, 37, 120)             0           
## ________________________________________________________________________________
## conv2d_2 (Conv2D)                   (None, 18, 18, 60)              64860       
## ________________________________________________________________________________
## conv2d_1 (Conv2D)                   (None, 8, 8, 60)                32460       
## ________________________________________________________________________________
## max_pooling2d (MaxPooling2D)        (None, 4, 4, 60)                0           
## ________________________________________________________________________________
## conv2d (Conv2D)                     (None, 1, 1, 40)                21640       
## ________________________________________________________________________________
## flatten (Flatten)                   (None, 40)                      0           
## ________________________________________________________________________________
## dense (Dense)                       (None, 2)                       82          
## ================================================================================
## Total params: 120,242
## Trainable params: 120,242
## Non-trainable params: 0
## ________________________________________________________________________________</code></pre>
</div>
<div id="compile-and-fit" class="section level2">
<h2>Compile and Fit</h2>
<p>Defining the Loss function and the optimization procedure are likewise very simple to do thanks to Keras.</p>
<pre class="r"><code>model %&gt;% 
  compile(
    loss = &quot;binary_crossentropy&quot;,
    optimizer = &quot;adam&quot;,
    metrics = &quot;accuracy&quot;
  )</code></pre>
<p>Here we are using the test data for validation during the learning process.</p>
<pre class="r"><code>history = 
  model %&gt;% 
  fit(
    x = X_train, y = y_train,
    validation_data = list(X_test, y_test),
    epochs = 10,
    batch_size = 10
  )</code></pre>
</div>
<div id="training-history" class="section level2">
<h2>Training History</h2>
<p>From the training history we can see that the model reaches a relatively good level of accuracy and perhaps begins to over-fit somewhat by the 6th epoch. Now we evaluate the model on the test data and see how well it does with unseen and unlabeled images.</p>
<pre class="r"><code>plotly::ggplotly(
  plot(history)
)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10],"y":[0.479816108942032,0.336556881666183,0.281245082616806,0.227771878242493,0.202724114060402,0.179117858409882,0.159499138593674,0.148727223277092,0.133692964911461,0.125996768474579],"text":["data: 1<br />data: training<br />epoch:  1<br />value: 0.4798161","data: 1<br />data: training<br />epoch:  2<br />value: 0.3365569","data: 1<br />data: training<br />epoch:  3<br />value: 0.2812451","data: 1<br />data: training<br />epoch:  4<br />value: 0.2277719","data: 1<br />data: training<br />epoch:  5<br />value: 0.2027241","data: 1<br />data: training<br />epoch:  6<br />value: 0.1791179","data: 1<br />data: training<br />epoch:  7<br />value: 0.1594991","data: 1<br />data: training<br />epoch:  8<br />value: 0.1487272","data: 1<br />data: training<br />epoch:  9<br />value: 0.1336930","data: 1<br />data: training<br />epoch: 10<br />value: 0.1259968"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"(training,1)","legendgroup":"(training,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10],"y":[0.772338628768921,0.857773959636688,0.890195250511169,0.916060984134674,0.925110459327698,0.934943735599518,0.942354261875153,0.946558356285095,0.953256368637085,0.953113853931427],"text":["data: 1<br />data: training<br />epoch:  1<br />value: 0.7723386","data: 1<br />data: training<br />epoch:  2<br />value: 0.8577740","data: 1<br />data: training<br />epoch:  3<br />value: 0.8901953","data: 1<br />data: training<br />epoch:  4<br />value: 0.9160610","data: 1<br />data: training<br />epoch:  5<br />value: 0.9251105","data: 1<br />data: training<br />epoch:  6<br />value: 0.9349437","data: 1<br />data: training<br />epoch:  7<br />value: 0.9423543","data: 1<br />data: training<br />epoch:  8<br />value: 0.9465584","data: 1<br />data: training<br />epoch:  9<br />value: 0.9532564","data: 1<br />data: training<br />epoch: 10<br />value: 0.9531139"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"(training,2)","legendgroup":"(training,2)","showlegend":true,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10],"y":[0.39173635840416,0.304464429616928,0.252672642469406,0.199009746313095,0.199805542826653,0.158314257860184,0.170130625367165,0.151747107505798,0.148341596126556,0.166123807430267],"text":["data: 1<br />data: validation<br />epoch:  1<br />value: 0.3917364","data: 1<br />data: validation<br />epoch:  2<br />value: 0.3044644","data: 1<br />data: validation<br />epoch:  3<br />value: 0.2526726","data: 1<br />data: validation<br />epoch:  4<br />value: 0.1990097","data: 1<br />data: validation<br />epoch:  5<br />value: 0.1998055","data: 1<br />data: validation<br />epoch:  6<br />value: 0.1583143","data: 1<br />data: validation<br />epoch:  7<br />value: 0.1701306","data: 1<br />data: validation<br />epoch:  8<br />value: 0.1517471","data: 1<br />data: validation<br />epoch:  9<br />value: 0.1483416","data: 1<br />data: validation<br />epoch: 10<br />value: 0.1661238"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"(validation,1)","legendgroup":"(validation,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10],"y":[0.84633332490921,0.871333360671997,0.904333353042603,0.938333332538605,0.92633330821991,0.944000005722046,0.938666641712189,0.947000026702881,0.946333348751068,0.941999971866608],"text":["data: 1<br />data: validation<br />epoch:  1<br />value: 0.8463333","data: 1<br />data: validation<br />epoch:  2<br />value: 0.8713334","data: 1<br />data: validation<br />epoch:  3<br />value: 0.9043334","data: 1<br />data: validation<br />epoch:  4<br />value: 0.9383333","data: 1<br />data: validation<br />epoch:  5<br />value: 0.9263333","data: 1<br />data: validation<br />epoch:  6<br />value: 0.9440000","data: 1<br />data: validation<br />epoch:  7<br />value: 0.9386666","data: 1<br />data: validation<br />epoch:  8<br />value: 0.9470000","data: 1<br />data: validation<br />epoch:  9<br />value: 0.9463333","data: 1<br />data: validation<br />epoch: 10<br />value: 0.9420000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"(validation,2)","legendgroup":"(validation,2)","showlegend":true,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,1.11392405063291,1.22784810126582,1.34177215189873,1.45569620253165,1.56962025316456,1.68354430379747,1.79746835443038,1.91139240506329,2.0253164556962,2.13924050632911,2.25316455696203,2.36708860759494,2.48101265822785,2.59493670886076,2.70886075949367,2.82278481012658,2.93670886075949,3.0506329113924,3.16455696202532,3.27848101265823,3.39240506329114,3.50632911392405,3.62025316455696,3.73417721518987,3.84810126582278,3.9620253164557,4.07594936708861,4.18987341772152,4.30379746835443,4.41772151898734,4.53164556962025,4.64556962025316,4.75949367088608,4.87341772151899,4.9873417721519,5.10126582278481,5.21518987341772,5.32911392405063,5.44303797468354,5.55696202531646,5.67088607594937,5.78481012658228,5.89873417721519,6.0126582278481,6.12658227848101,6.24050632911392,6.35443037974684,6.46835443037975,6.58227848101266,6.69620253164557,6.81012658227848,6.92405063291139,7.0379746835443,7.15189873417722,7.26582278481013,7.37974683544304,7.49367088607595,7.60759493670886,7.72151898734177,7.83544303797468,7.94936708860759,8.0632911392405,8.17721518987342,8.29113924050633,8.40506329113924,8.51898734177215,8.63291139240506,8.74683544303797,8.86075949367089,8.9746835443038,9.08860759493671,9.20253164556962,9.31645569620253,9.43037974683544,9.54430379746835,9.65822784810127,9.77215189873418,9.88607594936709,10],"y":[0.47111768504839,0.456413974146308,0.442153222646846,0.428330848156625,0.414942268282272,0.40198290063041,0.389448162807663,0.377333472420656,0.365634247076011,0.354348494248178,0.343537041622805,0.333208383191622,0.323337195932129,0.313898156821822,0.304865942838199,0.296215230958757,0.287920698160994,0.279957021422405,0.27237621565453,0.265688361775819,0.259854048354413,0.25470570624935,0.25007576631967,0.245796659424412,0.241700816422614,0.237620668173316,0.233388645535558,0.228997680216112,0.224861248553001,0.220977872191736,0.217308324274852,0.213813377944883,0.210453806344361,0.207190382615819,0.203983879901793,0.200795071344814,0.197717705643253,0.194908236643275,0.192319680348145,0.18990295473996,0.187608977800817,0.185388667512814,0.183192941858047,0.180972718818614,0.17868017342512,0.176396729778224,0.17418993254812,0.172052361644818,0.169976596978329,0.167955218458664,0.165980805995835,0.164045939499851,0.162143198880723,0.160267798204151,0.15844696242193,0.156685061247607,0.154976028026442,0.153313796103696,0.151692298824628,0.150105469534499,0.148547241578569,0.147011548302098,0.145498013952517,0.144029634857712,0.142607629078984,0.14122969650156,0.139893537010669,0.138596850491536,0.137337336829391,0.136112695909459,0.134920627616969,0.133761558080309,0.132640418557895,0.131557328488675,0.130512202993526,0.129504957193323,0.128535506208942,0.127603765161262,0.126709649171157,0.125853073359505],"text":["data: training<br />data: training<br />epoch:  1.000000<br />value: 0.4711177","data: training<br />data: training<br />epoch:  1.113924<br />value: 0.4564140","data: training<br />data: training<br />epoch:  1.227848<br />value: 0.4421532","data: training<br />data: training<br />epoch:  1.341772<br />value: 0.4283308","data: training<br />data: training<br />epoch:  1.455696<br />value: 0.4149423","data: training<br />data: training<br />epoch:  1.569620<br />value: 0.4019829","data: training<br />data: training<br />epoch:  1.683544<br />value: 0.3894482","data: training<br />data: training<br />epoch:  1.797468<br />value: 0.3773335","data: training<br />data: training<br />epoch:  1.911392<br />value: 0.3656342","data: training<br />data: training<br />epoch:  2.025316<br />value: 0.3543485","data: training<br />data: training<br />epoch:  2.139241<br />value: 0.3435370","data: training<br />data: training<br />epoch:  2.253165<br />value: 0.3332084","data: training<br />data: training<br />epoch:  2.367089<br />value: 0.3233372","data: training<br />data: training<br />epoch:  2.481013<br />value: 0.3138982","data: training<br />data: training<br />epoch:  2.594937<br />value: 0.3048659","data: training<br />data: training<br />epoch:  2.708861<br />value: 0.2962152","data: training<br />data: training<br />epoch:  2.822785<br />value: 0.2879207","data: training<br />data: training<br />epoch:  2.936709<br />value: 0.2799570","data: training<br />data: training<br />epoch:  3.050633<br />value: 0.2723762","data: training<br />data: training<br />epoch:  3.164557<br />value: 0.2656884","data: training<br />data: training<br />epoch:  3.278481<br />value: 0.2598540","data: training<br />data: training<br />epoch:  3.392405<br />value: 0.2547057","data: training<br />data: training<br />epoch:  3.506329<br />value: 0.2500758","data: training<br />data: training<br />epoch:  3.620253<br />value: 0.2457967","data: training<br />data: training<br />epoch:  3.734177<br />value: 0.2417008","data: training<br />data: training<br />epoch:  3.848101<br />value: 0.2376207","data: training<br />data: training<br />epoch:  3.962025<br />value: 0.2333886","data: training<br />data: training<br />epoch:  4.075949<br />value: 0.2289977","data: training<br />data: training<br />epoch:  4.189873<br />value: 0.2248612","data: training<br />data: training<br />epoch:  4.303797<br />value: 0.2209779","data: training<br />data: training<br />epoch:  4.417722<br />value: 0.2173083","data: training<br />data: training<br />epoch:  4.531646<br />value: 0.2138134","data: training<br />data: training<br />epoch:  4.645570<br />value: 0.2104538","data: training<br />data: training<br />epoch:  4.759494<br />value: 0.2071904","data: training<br />data: training<br />epoch:  4.873418<br />value: 0.2039839","data: training<br />data: training<br />epoch:  4.987342<br />value: 0.2007951","data: training<br />data: training<br />epoch:  5.101266<br />value: 0.1977177","data: training<br />data: training<br />epoch:  5.215190<br />value: 0.1949082","data: training<br />data: training<br />epoch:  5.329114<br />value: 0.1923197","data: training<br />data: training<br />epoch:  5.443038<br />value: 0.1899030","data: training<br />data: training<br />epoch:  5.556962<br />value: 0.1876090","data: training<br />data: training<br />epoch:  5.670886<br />value: 0.1853887","data: training<br />data: training<br />epoch:  5.784810<br />value: 0.1831929","data: training<br />data: training<br />epoch:  5.898734<br />value: 0.1809727","data: training<br />data: training<br />epoch:  6.012658<br />value: 0.1786802","data: training<br />data: training<br />epoch:  6.126582<br />value: 0.1763967","data: training<br />data: training<br />epoch:  6.240506<br />value: 0.1741899","data: training<br />data: training<br />epoch:  6.354430<br />value: 0.1720524","data: training<br />data: training<br />epoch:  6.468354<br />value: 0.1699766","data: training<br />data: training<br />epoch:  6.582278<br />value: 0.1679552","data: training<br />data: training<br />epoch:  6.696203<br />value: 0.1659808","data: training<br />data: training<br />epoch:  6.810127<br />value: 0.1640459","data: training<br />data: training<br />epoch:  6.924051<br />value: 0.1621432","data: training<br />data: training<br />epoch:  7.037975<br />value: 0.1602678","data: training<br />data: training<br />epoch:  7.151899<br />value: 0.1584470","data: training<br />data: training<br />epoch:  7.265823<br />value: 0.1566851","data: training<br />data: training<br />epoch:  7.379747<br />value: 0.1549760","data: training<br />data: training<br />epoch:  7.493671<br />value: 0.1533138","data: training<br />data: training<br />epoch:  7.607595<br />value: 0.1516923","data: training<br />data: training<br />epoch:  7.721519<br />value: 0.1501055","data: training<br />data: training<br />epoch:  7.835443<br />value: 0.1485472","data: training<br />data: training<br />epoch:  7.949367<br />value: 0.1470115","data: training<br />data: training<br />epoch:  8.063291<br />value: 0.1454980","data: training<br />data: training<br />epoch:  8.177215<br />value: 0.1440296","data: training<br />data: training<br />epoch:  8.291139<br />value: 0.1426076","data: training<br />data: training<br />epoch:  8.405063<br />value: 0.1412297","data: training<br />data: training<br />epoch:  8.518987<br />value: 0.1398935","data: training<br />data: training<br />epoch:  8.632911<br />value: 0.1385969","data: training<br />data: training<br />epoch:  8.746835<br />value: 0.1373373","data: training<br />data: training<br />epoch:  8.860759<br />value: 0.1361127","data: training<br />data: training<br />epoch:  8.974684<br />value: 0.1349206","data: training<br />data: training<br />epoch:  9.088608<br />value: 0.1337616","data: training<br />data: training<br />epoch:  9.202532<br />value: 0.1326404","data: training<br />data: training<br />epoch:  9.316456<br />value: 0.1315573","data: training<br />data: training<br />epoch:  9.430380<br />value: 0.1305122","data: training<br />data: training<br />epoch:  9.544304<br />value: 0.1295050","data: training<br />data: training<br />epoch:  9.658228<br />value: 0.1285355","data: training<br />data: training<br />epoch:  9.772152<br />value: 0.1276038","data: training<br />data: training<br />epoch:  9.886076<br />value: 0.1267096","data: training<br />data: training<br />epoch: 10.000000<br />value: 0.1258531"],"type":"scatter","mode":"lines","name":"training","line":{"width":3.77952755905512,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","legendgroup":"training","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1.11392405063291,1.22784810126582,1.34177215189873,1.45569620253165,1.56962025316456,1.68354430379747,1.79746835443038,1.91139240506329,2.0253164556962,2.13924050632911,2.25316455696203,2.36708860759494,2.48101265822785,2.59493670886076,2.70886075949367,2.82278481012658,2.93670886075949,3.0506329113924,3.16455696202532,3.27848101265823,3.39240506329114,3.50632911392405,3.62025316455696,3.73417721518987,3.84810126582278,3.9620253164557,4.07594936708861,4.18987341772152,4.30379746835443,4.41772151898734,4.53164556962025,4.64556962025316,4.75949367088608,4.87341772151899,4.9873417721519,5.10126582278481,5.21518987341772,5.32911392405063,5.44303797468354,5.55696202531646,5.67088607594937,5.78481012658228,5.89873417721519,6.0126582278481,6.12658227848101,6.24050632911392,6.35443037974684,6.46835443037975,6.58227848101266,6.69620253164557,6.81012658227848,6.92405063291139,7.0379746835443,7.15189873417722,7.26582278481013,7.37974683544304,7.49367088607595,7.60759493670886,7.72151898734177,7.83544303797468,7.94936708860759,8.0632911392405,8.17721518987342,8.29113924050633,8.40506329113924,8.51898734177215,8.63291139240506,8.74683544303797,8.86075949367089,8.9746835443038,9.08860759493671,9.20253164556962,9.31645569620253,9.43037974683544,9.54430379746835,9.65822784810127,9.77215189873418,9.88607594936709,10],"y":[0.777598490083341,0.786493918306784,0.795096395760036,0.803408817842486,0.81143407995352,0.819175077492525,0.826634705858887,0.833815860451994,0.840721436671233,0.847352573163858,0.853667895304364,0.859661785242842,0.865351603789779,0.870754711755665,0.87588846995099,0.880770239186242,0.88541738027191,0.889847254018484,0.894026638277252,0.89762206975034,0.900658370942456,0.903244090989542,0.905487779027538,0.907497984192386,0.909383255620027,0.911252142446401,0.91321319380745,0.915259284726707,0.917091594323474,0.918723123404796,0.920194534139771,0.921546488697493,0.922819649247058,0.924054677957564,0.925292236998104,0.926572988537776,0.927828073798095,0.928926843876729,0.929899324360156,0.930777233696941,0.93159229033565,0.93237621272485,0.933160719313105,0.933977528548982,0.934857575668273,0.935750770224923,0.93661407183154,0.937450829874712,0.938264393741025,0.939058112817068,0.939835336489427,0.94059941414469,0.941353695169442,0.942101801747002,0.942847985012201,0.943588421134702,0.944317533944945,0.945029747273369,0.945719484950413,0.946381170806518,0.947009228672124,0.94759808237767,0.948145928961899,0.948667631636129,0.949165249567598,0.949638604788813,0.950087519332286,0.950511815230523,0.950911314516035,0.95128583922133,0.951635211378917,0.951959604052876,0.952259619923464,0.952535109267642,0.952785893703314,0.953011794848389,0.953212634320772,0.953388233738371,0.953538414719093,0.953662998880844],"text":["data: training<br />data: training<br />epoch:  1.000000<br />value: 0.7775985","data: training<br />data: training<br />epoch:  1.113924<br />value: 0.7864939","data: training<br />data: training<br />epoch:  1.227848<br />value: 0.7950964","data: training<br />data: training<br />epoch:  1.341772<br />value: 0.8034088","data: training<br />data: training<br />epoch:  1.455696<br />value: 0.8114341","data: training<br />data: training<br />epoch:  1.569620<br />value: 0.8191751","data: training<br />data: training<br />epoch:  1.683544<br />value: 0.8266347","data: training<br />data: training<br />epoch:  1.797468<br />value: 0.8338159","data: training<br />data: training<br />epoch:  1.911392<br />value: 0.8407214","data: training<br />data: training<br />epoch:  2.025316<br />value: 0.8473526","data: training<br />data: training<br />epoch:  2.139241<br />value: 0.8536679","data: training<br />data: training<br />epoch:  2.253165<br />value: 0.8596618","data: training<br />data: training<br />epoch:  2.367089<br />value: 0.8653516","data: training<br />data: training<br />epoch:  2.481013<br />value: 0.8707547","data: training<br />data: training<br />epoch:  2.594937<br />value: 0.8758885","data: training<br />data: training<br />epoch:  2.708861<br />value: 0.8807702","data: training<br />data: training<br />epoch:  2.822785<br />value: 0.8854174","data: training<br />data: training<br />epoch:  2.936709<br />value: 0.8898473","data: training<br />data: training<br />epoch:  3.050633<br />value: 0.8940266","data: training<br />data: training<br />epoch:  3.164557<br />value: 0.8976221","data: training<br />data: training<br />epoch:  3.278481<br />value: 0.9006584","data: training<br />data: training<br />epoch:  3.392405<br />value: 0.9032441","data: training<br />data: training<br />epoch:  3.506329<br />value: 0.9054878","data: training<br />data: training<br />epoch:  3.620253<br />value: 0.9074980","data: training<br />data: training<br />epoch:  3.734177<br />value: 0.9093833","data: training<br />data: training<br />epoch:  3.848101<br />value: 0.9112521","data: training<br />data: training<br />epoch:  3.962025<br />value: 0.9132132","data: training<br />data: training<br />epoch:  4.075949<br />value: 0.9152593","data: training<br />data: training<br />epoch:  4.189873<br />value: 0.9170916","data: training<br />data: training<br />epoch:  4.303797<br />value: 0.9187231","data: training<br />data: training<br />epoch:  4.417722<br />value: 0.9201945","data: training<br />data: training<br />epoch:  4.531646<br />value: 0.9215465","data: training<br />data: training<br />epoch:  4.645570<br />value: 0.9228196","data: training<br />data: training<br />epoch:  4.759494<br />value: 0.9240547","data: training<br />data: training<br />epoch:  4.873418<br />value: 0.9252922","data: training<br />data: training<br />epoch:  4.987342<br />value: 0.9265730","data: training<br />data: training<br />epoch:  5.101266<br />value: 0.9278281","data: training<br />data: training<br />epoch:  5.215190<br />value: 0.9289268","data: training<br />data: training<br />epoch:  5.329114<br />value: 0.9298993","data: training<br />data: training<br />epoch:  5.443038<br />value: 0.9307772","data: training<br />data: training<br />epoch:  5.556962<br />value: 0.9315923","data: training<br />data: training<br />epoch:  5.670886<br />value: 0.9323762","data: training<br />data: training<br />epoch:  5.784810<br />value: 0.9331607","data: training<br />data: training<br />epoch:  5.898734<br />value: 0.9339775","data: training<br />data: training<br />epoch:  6.012658<br />value: 0.9348576","data: training<br />data: training<br />epoch:  6.126582<br />value: 0.9357508","data: training<br />data: training<br />epoch:  6.240506<br />value: 0.9366141","data: training<br />data: training<br />epoch:  6.354430<br />value: 0.9374508","data: training<br />data: training<br />epoch:  6.468354<br />value: 0.9382644","data: training<br />data: training<br />epoch:  6.582278<br />value: 0.9390581","data: training<br />data: training<br />epoch:  6.696203<br />value: 0.9398353","data: training<br />data: training<br />epoch:  6.810127<br />value: 0.9405994","data: training<br />data: training<br />epoch:  6.924051<br />value: 0.9413537","data: training<br />data: training<br />epoch:  7.037975<br />value: 0.9421018","data: training<br />data: training<br />epoch:  7.151899<br />value: 0.9428480","data: training<br />data: training<br />epoch:  7.265823<br />value: 0.9435884","data: training<br />data: training<br />epoch:  7.379747<br />value: 0.9443175","data: training<br />data: training<br />epoch:  7.493671<br />value: 0.9450297","data: training<br />data: training<br />epoch:  7.607595<br />value: 0.9457195","data: training<br />data: training<br />epoch:  7.721519<br />value: 0.9463812","data: training<br />data: training<br />epoch:  7.835443<br />value: 0.9470092","data: training<br />data: training<br />epoch:  7.949367<br />value: 0.9475981","data: training<br />data: training<br />epoch:  8.063291<br />value: 0.9481459","data: training<br />data: training<br />epoch:  8.177215<br />value: 0.9486676","data: training<br />data: training<br />epoch:  8.291139<br />value: 0.9491652","data: training<br />data: training<br />epoch:  8.405063<br />value: 0.9496386","data: training<br />data: training<br />epoch:  8.518987<br />value: 0.9500875","data: training<br />data: training<br />epoch:  8.632911<br />value: 0.9505118","data: training<br />data: training<br />epoch:  8.746835<br />value: 0.9509113","data: training<br />data: training<br />epoch:  8.860759<br />value: 0.9512858","data: training<br />data: training<br />epoch:  8.974684<br />value: 0.9516352","data: training<br />data: training<br />epoch:  9.088608<br />value: 0.9519596","data: training<br />data: training<br />epoch:  9.202532<br />value: 0.9522596","data: training<br />data: training<br />epoch:  9.316456<br />value: 0.9525351","data: training<br />data: training<br />epoch:  9.430380<br />value: 0.9527859","data: training<br />data: training<br />epoch:  9.544304<br />value: 0.9530118","data: training<br />data: training<br />epoch:  9.658228<br />value: 0.9532126","data: training<br />data: training<br />epoch:  9.772152<br />value: 0.9533882","data: training<br />data: training<br />epoch:  9.886076<br />value: 0.9535384","data: training<br />data: training<br />epoch: 10.000000<br />value: 0.9536630"],"type":"scatter","mode":"lines","name":"training","line":{"width":3.77952755905512,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","legendgroup":"training","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1,1.11392405063291,1.22784810126582,1.34177215189873,1.45569620253165,1.56962025316456,1.68354430379747,1.79746835443038,1.91139240506329,2.0253164556962,2.13924050632911,2.25316455696203,2.36708860759494,2.48101265822785,2.59493670886076,2.70886075949367,2.82278481012658,2.93670886075949,3.0506329113924,3.16455696202532,3.27848101265823,3.39240506329114,3.50632911392405,3.62025316455696,3.73417721518987,3.84810126582278,3.9620253164557,4.07594936708861,4.18987341772152,4.30379746835443,4.41772151898734,4.53164556962025,4.64556962025316,4.75949367088608,4.87341772151899,4.9873417721519,5.10126582278481,5.21518987341772,5.32911392405063,5.44303797468354,5.55696202531646,5.67088607594937,5.78481012658228,5.89873417721519,6.0126582278481,6.12658227848101,6.24050632911392,6.35443037974684,6.46835443037975,6.58227848101266,6.69620253164557,6.81012658227848,6.92405063291139,7.0379746835443,7.15189873417722,7.26582278481013,7.37974683544304,7.49367088607595,7.60759493670886,7.72151898734177,7.83544303797468,7.94936708860759,8.0632911392405,8.17721518987342,8.29113924050633,8.40506329113924,8.51898734177215,8.63291139240506,8.74683544303797,8.86075949367089,8.9746835443038,9.08860759493671,9.20253164556962,9.31645569620253,9.43037974683544,9.54430379746835,9.65822784810127,9.77215189873418,9.88607594936709,10],"y":[0.390030402367065,0.379766901322894,0.369771301482381,0.360042794908443,0.350580573663994,0.341383829811951,0.332451755415227,0.32378354253674,0.315378383239403,0.307236644003931,0.299386752643537,0.291832294137762,0.284561346272905,0.277561986835259,0.270822293611121,0.264330344386787,0.258074216948552,0.252041989082713,0.24625385010626,0.240921086276881,0.236028389141388,0.23150737139712,0.227289645741415,0.223306824871611,0.219490521485044,0.215772348279054,0.212083917950978,0.208419157522044,0.204938624638401,0.201645528178225,0.198528555374571,0.195576393460489,0.192777729669032,0.190121251233253,0.187595645386203,0.185189599360936,0.18300411616062,0.181162667162802,0.179596211642997,0.178233831297673,0.177004607823302,0.175837622916354,0.174661958273299,0.173406695590606,0.17200211826397,0.170511857510596,0.169017799194757,0.167536430635953,0.166084239153682,0.164677712067443,0.163333336696734,0.162067600361055,0.160896990379903,0.159830566084878,0.158790209734555,0.157768817889941,0.156789488759096,0.155875320550078,0.155049411470947,0.154334859729763,0.153754763534584,0.153332221093472,0.153073195834446,0.152909435523758,0.152832885834636,0.15284577150717,0.152950317281451,0.15314874789757,0.153443288095617,0.153836162615683,0.154329596197859,0.154922785061046,0.15561080502305,0.156394857864307,0.15727638615385,0.158256832460713,0.159337639353929,0.160520249402531,0.161806105175552,0.163196649242026],"text":["data: validation<br />data: validation<br />epoch:  1.000000<br />value: 0.3900304","data: validation<br />data: validation<br />epoch:  1.113924<br />value: 0.3797669","data: validation<br />data: validation<br />epoch:  1.227848<br />value: 0.3697713","data: validation<br />data: validation<br />epoch:  1.341772<br />value: 0.3600428","data: validation<br />data: validation<br />epoch:  1.455696<br />value: 0.3505806","data: validation<br />data: validation<br />epoch:  1.569620<br />value: 0.3413838","data: validation<br />data: validation<br />epoch:  1.683544<br />value: 0.3324518","data: validation<br />data: validation<br />epoch:  1.797468<br />value: 0.3237835","data: validation<br />data: validation<br />epoch:  1.911392<br />value: 0.3153784","data: validation<br />data: validation<br />epoch:  2.025316<br />value: 0.3072366","data: validation<br />data: validation<br />epoch:  2.139241<br />value: 0.2993868","data: validation<br />data: validation<br />epoch:  2.253165<br />value: 0.2918323","data: validation<br />data: validation<br />epoch:  2.367089<br />value: 0.2845613","data: validation<br />data: validation<br />epoch:  2.481013<br />value: 0.2775620","data: validation<br />data: validation<br />epoch:  2.594937<br />value: 0.2708223","data: validation<br />data: validation<br />epoch:  2.708861<br />value: 0.2643303","data: validation<br />data: validation<br />epoch:  2.822785<br />value: 0.2580742","data: validation<br />data: validation<br />epoch:  2.936709<br />value: 0.2520420","data: validation<br />data: validation<br />epoch:  3.050633<br />value: 0.2462539","data: validation<br />data: validation<br />epoch:  3.164557<br />value: 0.2409211","data: validation<br />data: validation<br />epoch:  3.278481<br />value: 0.2360284","data: validation<br />data: validation<br />epoch:  3.392405<br />value: 0.2315074","data: validation<br />data: validation<br />epoch:  3.506329<br />value: 0.2272896","data: validation<br />data: validation<br />epoch:  3.620253<br />value: 0.2233068","data: validation<br />data: validation<br />epoch:  3.734177<br />value: 0.2194905","data: validation<br />data: validation<br />epoch:  3.848101<br />value: 0.2157723","data: validation<br />data: validation<br />epoch:  3.962025<br />value: 0.2120839","data: validation<br />data: validation<br />epoch:  4.075949<br />value: 0.2084192","data: validation<br />data: validation<br />epoch:  4.189873<br />value: 0.2049386","data: validation<br />data: validation<br />epoch:  4.303797<br />value: 0.2016455","data: validation<br />data: validation<br />epoch:  4.417722<br />value: 0.1985286","data: validation<br />data: validation<br />epoch:  4.531646<br />value: 0.1955764","data: validation<br />data: validation<br />epoch:  4.645570<br />value: 0.1927777","data: validation<br />data: validation<br />epoch:  4.759494<br />value: 0.1901213","data: validation<br />data: validation<br />epoch:  4.873418<br />value: 0.1875956","data: validation<br />data: validation<br />epoch:  4.987342<br />value: 0.1851896","data: validation<br />data: validation<br />epoch:  5.101266<br />value: 0.1830041","data: validation<br />data: validation<br />epoch:  5.215190<br />value: 0.1811627","data: validation<br />data: validation<br />epoch:  5.329114<br />value: 0.1795962","data: validation<br />data: validation<br />epoch:  5.443038<br />value: 0.1782338","data: validation<br />data: validation<br />epoch:  5.556962<br />value: 0.1770046","data: validation<br />data: validation<br />epoch:  5.670886<br />value: 0.1758376","data: validation<br />data: validation<br />epoch:  5.784810<br />value: 0.1746620","data: validation<br />data: validation<br />epoch:  5.898734<br />value: 0.1734067","data: validation<br />data: validation<br />epoch:  6.012658<br />value: 0.1720021","data: validation<br />data: validation<br />epoch:  6.126582<br />value: 0.1705119","data: validation<br />data: validation<br />epoch:  6.240506<br />value: 0.1690178","data: validation<br />data: validation<br />epoch:  6.354430<br />value: 0.1675364","data: validation<br />data: validation<br />epoch:  6.468354<br />value: 0.1660842","data: validation<br />data: validation<br />epoch:  6.582278<br />value: 0.1646777","data: validation<br />data: validation<br />epoch:  6.696203<br />value: 0.1633333","data: validation<br />data: validation<br />epoch:  6.810127<br />value: 0.1620676","data: validation<br />data: validation<br />epoch:  6.924051<br />value: 0.1608970","data: validation<br />data: validation<br />epoch:  7.037975<br />value: 0.1598306","data: validation<br />data: validation<br />epoch:  7.151899<br />value: 0.1587902","data: validation<br />data: validation<br />epoch:  7.265823<br />value: 0.1577688","data: validation<br />data: validation<br />epoch:  7.379747<br />value: 0.1567895","data: validation<br />data: validation<br />epoch:  7.493671<br />value: 0.1558753","data: validation<br />data: validation<br />epoch:  7.607595<br />value: 0.1550494","data: validation<br />data: validation<br />epoch:  7.721519<br />value: 0.1543349","data: validation<br />data: validation<br />epoch:  7.835443<br />value: 0.1537548","data: validation<br />data: validation<br />epoch:  7.949367<br />value: 0.1533322","data: validation<br />data: validation<br />epoch:  8.063291<br />value: 0.1530732","data: validation<br />data: validation<br />epoch:  8.177215<br />value: 0.1529094","data: validation<br />data: validation<br />epoch:  8.291139<br />value: 0.1528329","data: validation<br />data: validation<br />epoch:  8.405063<br />value: 0.1528458","data: validation<br />data: validation<br />epoch:  8.518987<br />value: 0.1529503","data: validation<br />data: validation<br />epoch:  8.632911<br />value: 0.1531487","data: validation<br />data: validation<br />epoch:  8.746835<br />value: 0.1534433","data: validation<br />data: validation<br />epoch:  8.860759<br />value: 0.1538362","data: validation<br />data: validation<br />epoch:  8.974684<br />value: 0.1543296","data: validation<br />data: validation<br />epoch:  9.088608<br />value: 0.1549228","data: validation<br />data: validation<br />epoch:  9.202532<br />value: 0.1556108","data: validation<br />data: validation<br />epoch:  9.316456<br />value: 0.1563949","data: validation<br />data: validation<br />epoch:  9.430380<br />value: 0.1572764","data: validation<br />data: validation<br />epoch:  9.544304<br />value: 0.1582568","data: validation<br />data: validation<br />epoch:  9.658228<br />value: 0.1593376","data: validation<br />data: validation<br />epoch:  9.772152<br />value: 0.1605202","data: validation<br />data: validation<br />epoch:  9.886076<br />value: 0.1618061","data: validation<br />data: validation<br />epoch: 10.000000<br />value: 0.1631966"],"type":"scatter","mode":"lines","name":"validation","line":{"width":3.77952755905512,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","legendgroup":"validation","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1.11392405063291,1.22784810126582,1.34177215189873,1.45569620253165,1.56962025316456,1.68354430379747,1.79746835443038,1.91139240506329,2.0253164556962,2.13924050632911,2.25316455696203,2.36708860759494,2.48101265822785,2.59493670886076,2.70886075949367,2.82278481012658,2.93670886075949,3.0506329113924,3.16455696202532,3.27848101265823,3.39240506329114,3.50632911392405,3.62025316455696,3.73417721518987,3.84810126582278,3.9620253164557,4.07594936708861,4.18987341772152,4.30379746835443,4.41772151898734,4.53164556962025,4.64556962025316,4.75949367088608,4.87341772151899,4.9873417721519,5.10126582278481,5.21518987341772,5.32911392405063,5.44303797468354,5.55696202531646,5.67088607594937,5.78481012658228,5.89873417721519,6.0126582278481,6.12658227848101,6.24050632911392,6.35443037974684,6.46835443037975,6.58227848101266,6.69620253164557,6.81012658227848,6.92405063291139,7.0379746835443,7.15189873417722,7.26582278481013,7.37974683544304,7.49367088607595,7.60759493670886,7.72151898734177,7.83544303797468,7.94936708860759,8.0632911392405,8.17721518987342,8.29113924050633,8.40506329113924,8.51898734177215,8.63291139240506,8.74683544303797,8.86075949367089,8.9746835443038,9.08860759493671,9.20253164556962,9.31645569620253,9.43037974683544,9.54430379746835,9.65822784810127,9.77215189873418,9.88607594936709,10],"y":[0.842815616786409,0.847223665113846,0.851545885606741,0.85578015901829,0.859924366101688,0.863976387610132,0.867934104296819,0.871795396914945,0.875558146217706,0.879220909164361,0.882798914752114,0.886294432645003,0.889701012287006,0.893012203122097,0.896221554594254,0.899322616147451,0.902308937225665,0.905174067272871,0.907931919912967,0.910717071662589,0.913519492094394,0.916295412069734,0.919001062449963,0.921592674096434,0.924026477870499,0.926258704633513,0.928245585246828,0.929930445593671,0.931276094878966,0.932338399107187,0.933178391308239,0.933857104512028,0.934435571748458,0.934974826047436,0.935535900438866,0.936179827952655,0.936767052978175,0.937062631779105,0.937137956579383,0.937067581621885,0.936926061149485,0.936787949405057,0.936727800631477,0.936820169071617,0.937138957601965,0.937671128158858,0.938346538320377,0.93912111086275,0.939950768562202,0.940791434194961,0.941599030537253,0.942329480365304,0.942938706455342,0.943391783599703,0.943776757027753,0.944127239591713,0.944443522640283,0.944725897522165,0.94497465558606,0.945190088180669,0.945372486654694,0.945522142356835,0.945639113704359,0.945722563320506,0.945772630271008,0.945789602588546,0.945773768305801,0.945725415455456,0.945644832070191,0.945532306182687,0.945388125825627,0.945212213853605,0.945003705688489,0.944762218876801,0.944487395458708,0.944178877474379,0.94383630696398,0.943459325967679,0.943047576525645,0.942600700678044],"text":["data: validation<br />data: validation<br />epoch:  1.000000<br />value: 0.8428156","data: validation<br />data: validation<br />epoch:  1.113924<br />value: 0.8472237","data: validation<br />data: validation<br />epoch:  1.227848<br />value: 0.8515459","data: validation<br />data: validation<br />epoch:  1.341772<br />value: 0.8557802","data: validation<br />data: validation<br />epoch:  1.455696<br />value: 0.8599244","data: validation<br />data: validation<br />epoch:  1.569620<br />value: 0.8639764","data: validation<br />data: validation<br />epoch:  1.683544<br />value: 0.8679341","data: validation<br />data: validation<br />epoch:  1.797468<br />value: 0.8717954","data: validation<br />data: validation<br />epoch:  1.911392<br />value: 0.8755581","data: validation<br />data: validation<br />epoch:  2.025316<br />value: 0.8792209","data: validation<br />data: validation<br />epoch:  2.139241<br />value: 0.8827989","data: validation<br />data: validation<br />epoch:  2.253165<br />value: 0.8862944","data: validation<br />data: validation<br />epoch:  2.367089<br />value: 0.8897010","data: validation<br />data: validation<br />epoch:  2.481013<br />value: 0.8930122","data: validation<br />data: validation<br />epoch:  2.594937<br />value: 0.8962216","data: validation<br />data: validation<br />epoch:  2.708861<br />value: 0.8993226","data: validation<br />data: validation<br />epoch:  2.822785<br />value: 0.9023089","data: validation<br />data: validation<br />epoch:  2.936709<br />value: 0.9051741","data: validation<br />data: validation<br />epoch:  3.050633<br />value: 0.9079319","data: validation<br />data: validation<br />epoch:  3.164557<br />value: 0.9107171","data: validation<br />data: validation<br />epoch:  3.278481<br />value: 0.9135195","data: validation<br />data: validation<br />epoch:  3.392405<br />value: 0.9162954","data: validation<br />data: validation<br />epoch:  3.506329<br />value: 0.9190011","data: validation<br />data: validation<br />epoch:  3.620253<br />value: 0.9215927","data: validation<br />data: validation<br />epoch:  3.734177<br />value: 0.9240265","data: validation<br />data: validation<br />epoch:  3.848101<br />value: 0.9262587","data: validation<br />data: validation<br />epoch:  3.962025<br />value: 0.9282456","data: validation<br />data: validation<br />epoch:  4.075949<br />value: 0.9299304","data: validation<br />data: validation<br />epoch:  4.189873<br />value: 0.9312761","data: validation<br />data: validation<br />epoch:  4.303797<br />value: 0.9323384","data: validation<br />data: validation<br />epoch:  4.417722<br />value: 0.9331784","data: validation<br />data: validation<br />epoch:  4.531646<br />value: 0.9338571","data: validation<br />data: validation<br />epoch:  4.645570<br />value: 0.9344356","data: validation<br />data: validation<br />epoch:  4.759494<br />value: 0.9349748","data: validation<br />data: validation<br />epoch:  4.873418<br />value: 0.9355359","data: validation<br />data: validation<br />epoch:  4.987342<br />value: 0.9361798","data: validation<br />data: validation<br />epoch:  5.101266<br />value: 0.9367671","data: validation<br />data: validation<br />epoch:  5.215190<br />value: 0.9370626","data: validation<br />data: validation<br />epoch:  5.329114<br />value: 0.9371380","data: validation<br />data: validation<br />epoch:  5.443038<br />value: 0.9370676","data: validation<br />data: validation<br />epoch:  5.556962<br />value: 0.9369261","data: validation<br />data: validation<br />epoch:  5.670886<br />value: 0.9367879","data: validation<br />data: validation<br />epoch:  5.784810<br />value: 0.9367278","data: validation<br />data: validation<br />epoch:  5.898734<br />value: 0.9368202","data: validation<br />data: validation<br />epoch:  6.012658<br />value: 0.9371390","data: validation<br />data: validation<br />epoch:  6.126582<br />value: 0.9376711","data: validation<br />data: validation<br />epoch:  6.240506<br />value: 0.9383465","data: validation<br />data: validation<br />epoch:  6.354430<br />value: 0.9391211","data: validation<br />data: validation<br />epoch:  6.468354<br />value: 0.9399508","data: validation<br />data: validation<br />epoch:  6.582278<br />value: 0.9407914","data: validation<br />data: validation<br />epoch:  6.696203<br />value: 0.9415990","data: validation<br />data: validation<br />epoch:  6.810127<br />value: 0.9423295","data: validation<br />data: validation<br />epoch:  6.924051<br />value: 0.9429387","data: validation<br />data: validation<br />epoch:  7.037975<br />value: 0.9433918","data: validation<br />data: validation<br />epoch:  7.151899<br />value: 0.9437768","data: validation<br />data: validation<br />epoch:  7.265823<br />value: 0.9441272","data: validation<br />data: validation<br />epoch:  7.379747<br />value: 0.9444435","data: validation<br />data: validation<br />epoch:  7.493671<br />value: 0.9447259","data: validation<br />data: validation<br />epoch:  7.607595<br />value: 0.9449747","data: validation<br />data: validation<br />epoch:  7.721519<br />value: 0.9451901","data: validation<br />data: validation<br />epoch:  7.835443<br />value: 0.9453725","data: validation<br />data: validation<br />epoch:  7.949367<br />value: 0.9455221","data: validation<br />data: validation<br />epoch:  8.063291<br />value: 0.9456391","data: validation<br />data: validation<br />epoch:  8.177215<br />value: 0.9457226","data: validation<br />data: validation<br />epoch:  8.291139<br />value: 0.9457726","data: validation<br />data: validation<br />epoch:  8.405063<br />value: 0.9457896","data: validation<br />data: validation<br />epoch:  8.518987<br />value: 0.9457738","data: validation<br />data: validation<br />epoch:  8.632911<br />value: 0.9457254","data: validation<br />data: validation<br />epoch:  8.746835<br />value: 0.9456448","data: validation<br />data: validation<br />epoch:  8.860759<br />value: 0.9455323","data: validation<br />data: validation<br />epoch:  8.974684<br />value: 0.9453881","data: validation<br />data: validation<br />epoch:  9.088608<br />value: 0.9452122","data: validation<br />data: validation<br />epoch:  9.202532<br />value: 0.9450037","data: validation<br />data: validation<br />epoch:  9.316456<br />value: 0.9447622","data: validation<br />data: validation<br />epoch:  9.430380<br />value: 0.9444874","data: validation<br />data: validation<br />epoch:  9.544304<br />value: 0.9441789","data: validation<br />data: validation<br />epoch:  9.658228<br />value: 0.9438363","data: validation<br />data: validation<br />epoch:  9.772152<br />value: 0.9434593","data: validation<br />data: validation<br />epoch:  9.886076<br />value: 0.9430476","data: validation<br />data: validation<br />epoch: 10.000000<br />value: 0.9426007"],"type":"scatter","mode":"lines","name":"validation","line":{"width":3.77952755905512,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","legendgroup":"validation","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.8401826484018,"r":21.9178082191781,"b":40.1826484018265,"l":28.4931506849315},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.55,10.45],"tickmode":"array","ticktext":["2","4","6","8","10"],"tickvals":[2,4,6,8,10],"categoryorder":"array","categoryarray":["2","4","6","8","10"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y2","title":"","hoverformat":".2f"},"annotations":[{"text":"epoch","x":0.5,"y":-0.0471841704718417,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis"},{"text":"loss","x":1,"y":0.757610350076104,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"accuracy","x":1,"y":0.242389649923896,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"data","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"yaxis":{"domain":[0.515220700152207,1],"automargin":true,"type":"linear","autorange":false,"range":[0.108154921580378,0.497514260721158],"tickmode":"array","ticktext":["0.2","0.3","0.4"],"tickvals":[0.2,0.3,0.4],"categoryorder":"array","categoryarray":["0.2","0.3","0.4"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.515220700152207,"y1":1},{"type":"rect","fillcolor":"transparent","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.515220700152207,"y1":1,"x0":0,"x1":26.3013698630137,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":0.484779299847793},{"type":"rect","fillcolor":"transparent","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0,"y1":0.484779299847793,"x0":0,"x1":26.3013698630137,"xanchor":1,"xsizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":false,"range":[0.763272410263325,0.96272921738644],"tickmode":"array","ticktext":["0.80","0.85","0.90","0.95"],"tickvals":[0.8,0.85,0.9,0.95],"categoryorder":"array","categoryarray":["0.80","0.85","0.90","0.95"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.484779299847793],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.913385826771654},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"b9896dddc6e7":{"colour":{},"fill":{},"x":{},"y":{},"type":"scatter"},"b9897b2da00a":{"colour":{},"fill":{},"x":{},"y":{}}},"cur_data":"b9896dddc6e7","visdat":{"b9896dddc6e7":["function (y) ","x"],"b9897b2da00a":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="save" class="section level2">
<h2>Save</h2>
<p>For some reason before using the model for prediction on my machine I need to save it and load it each time.</p>
<pre class="r"><code>save_model_tf(model, paste0(path,&quot;/tf_models/binary_gray_img_classification&quot;), overwrite = TRUE)</code></pre>
</div>
</div>
<div id="evaluation" class="section level1">
<h1>Evaluation</h1>
<div id="model-accuracy" class="section level2">
<h2>Model Accuracy</h2>
<pre class="r"><code>smodel = load_model_tf(paste0(path,&quot;/tf_models/binary_gray_img_classification&quot;), compile = TRUE)

tpred = vector(mode = &quot;character&quot;, length = dim(X_test)[1])
for(i in 1:dim(X_test)[1]){
  tpred[i] = c(&quot;city/building&quot;,&quot;nature&quot;)[which.max(smodel %&gt;% predict(X_test[i, , , ,drop = FALSE]))]
}


conf = table(tpred, test_labels)/length(tpred)
round(conf,2)</code></pre>
<pre><code>##                test_labels
## tpred           city/building nature
##   city/building          0.27   0.01
##   nature                 0.05   0.68</code></pre>
<pre class="r"><code>round(sum(diag(conf)),2)</code></pre>
<pre><code>## [1] 0.94</code></pre>
<pre class="r"><code>round(1 - sum(diag(conf)),2)</code></pre>
<pre><code>## [1] 0.06</code></pre>
</div>
<div id="validation-on-unseen-images" class="section level2">
<h2>Validation on Unseen Images</h2>
<pre class="r"><code>val_image_files = list.files(paste0(path,&quot;/data/seg_pred/seg_pred&quot;), recursive = TRUE, full.names = TRUE)

val_data = map(val_image_files[1:400], 
                ~image_load(.x, target_size = c(150,150), grayscale = TRUE) %&gt;% 
                  image_to_array() %&gt;% 
                  magrittr::divide_by(255)
)

X_val = array(unlist(val_data), dim = c(150, 150, 1, length(val_data))) %&gt;% aperm(c(4,1,2,3))

par(mfrow = c(2,2), mar = c(1,1,1,1))
as.cimg(X_val[1, , , ]) %&gt;% imrotate(90) %&gt;% plot(axes = FALSE)
as.cimg(X_val[2, , , ]) %&gt;% imrotate(90) %&gt;% plot(axes = FALSE)
as.cimg(X_val[3, , , ]) %&gt;% imrotate(90) %&gt;% plot(axes = FALSE)
as.cimg(X_val[4, , , ]) %&gt;% imrotate(90) %&gt;% plot(axes = FALSE)</code></pre>
<p><img src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>smodel = load_model_tf(paste0(path,&quot;/tf_models/binary_gray_img_classification&quot;), compile = TRUE)

vpred = vector(mode = &quot;character&quot;, length = dim(X_val)[1])
for(i in 1:dim(X_val)[1]){
  vpred[i] = c(&quot;city/building&quot;,&quot;nature&quot;)[which.max(smodel %&gt;% predict(X_val[i, , , ,drop = FALSE]))]
}</code></pre>
<pre class="r"><code>set.seed(123)

par(mfrow = c(4,4), mar = c(1,1,1,1))
ri = sample(1:length(vpred), 16)
map(ri, ~ as.cimg(X_val[.x, , , ]) %&gt;% imrotate(90) %&gt;% plot(axes = FALSE, main = vpred[.x]))</code></pre>
<p><img src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre><code>## [[1]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[2]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[3]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[4]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[5]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[6]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[7]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[8]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[9]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[10]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[11]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[12]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[13]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[14]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[15]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1 
## 
## [[16]]
## Image. Width: 150 pix Height: 150 pix Depth: 1 Colour channels: 1</code></pre>
</div>
<div id="examples-of-miss-classification" class="section level2">
<h2>Examples of Miss-Classification</h2>
<pre class="r"><code>smodel = load_model_tf(paste0(path,&quot;/tf_models/binary_gray_img_classification&quot;), compile = TRUE)

fi = which(tpred != test_labels)
par(mfrow = c(4,4), mar = c(1,1,1,1))
set.seed(123)
ri = sample(fi, 16)

for(i in ri){
  propbs = smodel %&gt;% predict(X_test[i, , , ,drop = FALSE])
  lab = str_c(c(&quot;city/building&quot;,&quot;nature&quot;), round(propbs,2), sep = &quot;:&quot;, collapse = &quot; / &quot;)
  as.cimg(X_test[i, , , ]) %&gt;% imrotate(90) %&gt;% plot(axes = FALSE, main = tpred[i])
  text(75, 130, labels = lab, col = 2, cex = 1)
}</code></pre>
<p><img src="https://bdshaff.github.io/blog/2021-05-31-binary-image-classification-with-keras-in-r/index_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
</div>



                </div>

                
            </div>
        </div>
    </div>
</div>

<section id="comments">
    <div class="py-3 content">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-sm-12 col-lg-8">
                    <div class="comments">
                        <script src="https://utteranc.es/client.js" repo=""
                            issue-term="pathname" label="comment" theme="github-light" crossorigin="anonymous" async>
                            </script>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>



    

    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js" defer></script>
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/python.min.js" defer></script>
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/stan.min.js" defer></script>
        
        <script>
            window.addEventListener('load', function() {
                hljs.initHighlighting();
            }, true);
        </script>
    

    

    
    
        

    
</body>

</html>
